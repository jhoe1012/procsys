import{r as V,b as wn,g as hr,e as E}from"./app-btmnkiCu.js";var On={},En={},xn={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i,l,c){let p=c.initialDeps??[],s;return()=>{var u,g,f,S;let w;c.key&&((u=c.debug)!=null&&u.call(c))&&(w=Date.now());const C=i();if(!(C.length!==p.length||C.some((d,v)=>p[v]!==d)))return s;p=C;let I;if(c.key&&((g=c.debug)!=null&&g.call(c))&&(I=Date.now()),s=l(...C),c.key&&((f=c.debug)!=null&&f.call(c))){const d=Math.round((Date.now()-w)*100)/100,v=Math.round((Date.now()-I)*100)/100,b=v/16,O=(M,T)=>{for(M=String(M);M.length<T;)M=" "+M;return M};console.info(`%câ± ${O(v,5)} /${O(d,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*b,120))}deg 100% 31%);`,c==null?void 0:c.key)}return(S=c==null?void 0:c.onChange)==null||S.call(c,s),s}}function n(i,l){if(i===void 0)throw new Error(`Unexpected undefined${l?`: ${l}`:""}`);return i}const r=(i,l)=>Math.abs(i-l)<1,o=(i,l)=>{let c;return function(...p){clearTimeout(c),c=setTimeout(()=>i.apply(this,p),l)}};e.approxEqual=r,e.debounce=o,e.memo=t,e.notUndefined=n})(xn);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xn,n=y=>y,r=y=>{const I=Math.max(y.startIndex-y.overscan,0),d=Math.min(y.endIndex+y.overscan,y.count-1),v=[];for(let b=I;b<=d;b++)v.push(b);return v},o=(y,I)=>{const d=y.scrollElement;if(!d)return;const v=O=>{const{width:M,height:T}=O;I({width:Math.round(M),height:Math.round(T)})};if(v(d.getBoundingClientRect()),typeof ResizeObserver>"u")return()=>{};const b=new ResizeObserver(O=>{const M=O[0];if(M!=null&&M.borderBoxSize){const T=M.borderBoxSize[0];if(T){v({width:T.inlineSize,height:T.blockSize});return}}v(d.getBoundingClientRect())});return b.observe(d,{box:"border-box"}),()=>{b.unobserve(d)}},i={passive:!0},l=(y,I)=>{const d=y.scrollElement;if(!d)return;const v=()=>{I({width:d.innerWidth,height:d.innerHeight})};return v(),d.addEventListener("resize",v,i),()=>{d.removeEventListener("resize",v)}},c=typeof window>"u"?!0:"onscrollend"in window,p=(y,I)=>{const d=y.scrollElement;if(!d)return;let v=0;const b=c?()=>{}:t.debounce(()=>{I(v,!1)},y.options.isScrollingResetDelay),O=$=>()=>{v=d[y.options.horizontal?"scrollLeft":"scrollTop"],b(),I(v,$)},M=O(!0),T=O(!1);return T(),d.addEventListener("scroll",M,i),d.addEventListener("scrollend",T,i),()=>{d.removeEventListener("scroll",M),d.removeEventListener("scrollend",T)}},s=(y,I)=>{const d=y.scrollElement;if(!d)return;let v=0;const b=c?()=>{}:t.debounce(()=>{I(v,!1)},y.options.isScrollingResetDelay),O=$=>()=>{v=d[y.options.horizontal?"scrollX":"scrollY"],b(),I(v,$)},M=O(!0),T=O(!1);return T(),d.addEventListener("scroll",M,i),d.addEventListener("scrollend",T,i),()=>{d.removeEventListener("scroll",M),d.removeEventListener("scrollend",T)}},u=(y,I,d)=>{if(I!=null&&I.borderBoxSize){const v=I.borderBoxSize[0];if(v)return Math.round(v[d.options.horizontal?"inlineSize":"blockSize"])}return Math.round(y.getBoundingClientRect()[d.options.horizontal?"width":"height"])},g=(y,{adjustments:I=0,behavior:d},v)=>{var b,O;const M=y+I;(O=(b=v.scrollElement)==null?void 0:b.scrollTo)==null||O.call(b,{[v.options.horizontal?"left":"top"]:M,behavior:d})},f=(y,{adjustments:I=0,behavior:d},v)=>{var b,O;const M=y+I;(O=(b=v.scrollElement)==null?void 0:b.scrollTo)==null||O.call(b,{[v.options.horizontal?"left":"top"]:M,behavior:d})};class S{constructor(I){this.unsubs=[],this.scrollElement=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=(()=>{let d=null;const v=()=>d||(typeof ResizeObserver<"u"?d=new ResizeObserver(b=>{b.forEach(O=>{this._measureElement(O.target,O)})}):null);return{disconnect:()=>{var b;return(b=v())==null?void 0:b.disconnect()},observe:b=>{var O;return(O=v())==null?void 0:O.observe(b,{box:"border-box"})},unobserve:b=>{var O;return(O=v())==null?void 0:O.unobserve(b)}}})(),this.range=null,this.setOptions=d=>{Object.entries(d).forEach(([v,b])=>{typeof b>"u"&&delete d[v]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:n,rangeExtractor:r,onChange:()=>{},measureElement:u,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,...d}},this.notify=(d,v)=>{var b,O;const{startIndex:M,endIndex:T}=this.range??{startIndex:void 0,endIndex:void 0},$=this.calculateRange();(d||M!==($==null?void 0:$.startIndex)||T!==($==null?void 0:$.endIndex))&&((O=(b=this.options).onChange)==null||O.call(b,this,v))},this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(d=>d()),this.unsubs=[],this.scrollElement=null},this._didMount=()=>(this.measureElementCache.forEach(this.observer.observe),()=>{this.observer.disconnect(),this.cleanup()}),this._willUpdate=()=>{const d=this.options.getScrollElement();this.scrollElement!==d&&(this.cleanup(),this.scrollElement=d,this._scrollToOffset(this.scrollOffset,{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,v=>{this.scrollRect=v,this.notify(!1,!1)})),this.unsubs.push(this.options.observeElementOffset(this,(v,b)=>{this.scrollAdjustments=0,this.scrollDirection=b?this.scrollOffset<v?"forward":"backward":null,this.scrollOffset=v;const O=this.isScrolling;this.isScrolling=b,this.notify(O!==b,b)})))},this.getSize=()=>this.scrollRect[this.options.horizontal?"width":"height"],this.getMeasurementOptions=t.memo(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey],(d,v,b,O)=>(this.pendingMeasuredCacheIndexes=[],{count:d,paddingStart:v,scrollMargin:b,getItemKey:O}),{key:!1}),this.getFurthestMeasurement=(d,v)=>{const b=new Map,O=new Map;for(let M=v-1;M>=0;M--){const T=d[M];if(b.has(T.lane))continue;const $=O.get(T.lane);if($==null||T.end>$.end?O.set(T.lane,T):T.end<$.end&&b.set(T.lane,!0),b.size===this.options.lanes)break}return O.size===this.options.lanes?Array.from(O.values()).sort((M,T)=>M.end===T.end?M.index-T.index:M.end-T.end)[0]:void 0},this.getMeasurements=t.memo(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:d,paddingStart:v,scrollMargin:b,getItemKey:O},M)=>{const T=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const $=this.measurementsCache.slice(0,T);for(let H=T;H<d;H++){const ie=O(H),re=this.options.lanes===1?$[H-1]:this.getFurthestMeasurement($,H),U=re?re.end+this.options.gap:v+b,x=M.get(ie),k=typeof x=="number"?x:this.options.estimateSize(H),X=U+k,F=re?re.lane:H%this.options.lanes;$[H]={index:H,start:U,size:k,end:X,key:ie,lane:F}}return this.measurementsCache=$,$},{key:!1,debug:()=>this.options.debug}),this.calculateRange=t.memo(()=>[this.getMeasurements(),this.getSize(),this.scrollOffset],(d,v,b)=>this.range=d.length>0&&v>0?C({measurements:d,outerSize:v,scrollOffset:b}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=t.memo(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(d,v,b,O)=>v===null?[]:d({startIndex:v.startIndex,endIndex:v.endIndex,overscan:b,count:O}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=d=>{const v=this.options.indexAttribute,b=d.getAttribute(v);return b?parseInt(b,10):(console.warn(`Missing attribute name '${v}={index}' on measured element.`),-1)},this._measureElement=(d,v)=>{const b=this.measurementsCache[this.indexFromElement(d)];if(!b||!d.isConnected){this.measureElementCache.forEach((T,$)=>{T===d&&(this.observer.unobserve(d),this.measureElementCache.delete($))});return}const O=this.measureElementCache.get(b.key);O!==d&&(O&&this.observer.unobserve(O),this.observer.observe(d),this.measureElementCache.set(b.key,d));const M=this.options.measureElement(d,v,this);this.resizeItem(b,M)},this.resizeItem=(d,v)=>{const b=this.itemSizeCache.get(d.key)??d.size,O=v-b;O!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(d,O,this):d.start<this.scrollOffset+this.scrollAdjustments)&&this._scrollToOffset(this.scrollOffset,{adjustments:this.scrollAdjustments+=O,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(d.index),this.itemSizeCache=new Map(this.itemSizeCache.set(d.key,v)),this.notify(!0,!1))},this.measureElement=d=>{d&&this._measureElement(d,void 0)},this.getVirtualItems=t.memo(()=>[this.getIndexes(),this.getMeasurements()],(d,v)=>{const b=[];for(let O=0,M=d.length;O<M;O++){const T=d[O],$=v[T];b.push($)}return b},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=d=>{const v=this.getMeasurements();return t.notUndefined(v[w(0,v.length-1,b=>t.notUndefined(v[b]).start,d)])},this.getOffsetForAlignment=(d,v)=>{const b=this.getSize();v==="auto"&&(d<=this.scrollOffset?v="start":d>=this.scrollOffset+b?v="end":v="start"),v==="start"?d=d:v==="end"?d=d-b:v==="center"&&(d=d-b/2);const O=this.options.horizontal?"scrollWidth":"scrollHeight",T=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[O]:this.scrollElement[O]:0)-this.getSize();return Math.max(Math.min(T,d),0)},this.getOffsetForIndex=(d,v="auto")=>{d=Math.max(0,Math.min(d,this.options.count-1));const b=t.notUndefined(this.getMeasurements()[d]);if(v==="auto")if(b.end>=this.scrollOffset+this.getSize()-this.options.scrollPaddingEnd)v="end";else if(b.start<=this.scrollOffset+this.options.scrollPaddingStart)v="start";else return[this.scrollOffset,v];const O=v==="end"?b.end+this.options.scrollPaddingEnd:b.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(O,v),v]},this.isDynamicMode=()=>this.measureElementCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&(clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(d,{align:v="start",behavior:b}={})=>{this.cancelScrollToIndex(),b==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(d,v),{adjustments:void 0,behavior:b})},this.scrollToIndex=(d,{align:v="auto",behavior:b}={})=>{d=Math.max(0,Math.min(d,this.options.count-1)),this.cancelScrollToIndex(),b==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const[O,M]=this.getOffsetForIndex(d,v);this._scrollToOffset(O,{adjustments:void 0,behavior:b}),b!=="smooth"&&this.isDynamicMode()&&(this.scrollToIndexTimeoutId=setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.measureElementCache.has(this.options.getItemKey(d))){const[$]=this.getOffsetForIndex(d,M);t.approxEqual($,this.scrollOffset)||this.scrollToIndex(d,{align:M,behavior:b})}else this.scrollToIndex(d,{align:M,behavior:b})}))},this.scrollBy=(d,{behavior:v}={})=>{this.cancelScrollToIndex(),v==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.scrollOffset+d,{adjustments:void 0,behavior:v})},this.getTotalSize=()=>{var d;const v=this.getMeasurements();let b;return v.length===0?b=this.options.paddingStart:b=this.options.lanes===1?((d=v[v.length-1])==null?void 0:d.end)??0:Math.max(...v.slice(-this.options.lanes).map(O=>O.end)),b-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(d,{adjustments:v,behavior:b})=>{this.options.scrollToFn(d,{behavior:b,adjustments:v},this)},this.measure=()=>{var d,v;this.itemSizeCache=new Map,(v=(d=this.options).onChange)==null||v.call(d,this,!1)},this.setOptions(I),this.scrollRect=this.options.initialRect,this.scrollOffset=typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(d=>{this.itemSizeCache.set(d.key,d.size)}),this.notify(!1,!1)}}const w=(y,I,d,v)=>{for(;y<=I;){const b=(y+I)/2|0,O=d(b);if(O<v)y=b+1;else if(O>v)I=b-1;else return b}return y>0?y-1:0};function C({measurements:y,outerSize:I,scrollOffset:d}){const v=y.length-1,O=w(0,v,T=>y[T].start,d);let M=O;for(;M<v&&y[M].end<d+I;)M++;return{startIndex:O,endIndex:M}}e.approxEqual=t.approxEqual,e.debounce=t.debounce,e.memo=t.memo,e.notUndefined=t.notUndefined,e.Virtualizer=S,e.defaultKeyExtractor=n,e.defaultRangeExtractor=r,e.elementScroll=f,e.measureElement=u,e.observeElementOffset=p,e.observeElementRect=o,e.observeWindowOffset=s,e.observeWindowRect=l,e.windowScroll=g})(En);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=V,n=wn,r=En;function o(u){const g=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(u){for(const f in u)if(f!=="default"){const S=Object.getOwnPropertyDescriptor(u,f);Object.defineProperty(g,f,S.get?S:{enumerable:!0,get:()=>u[f]})}}return g.default=u,Object.freeze(g)}const i=o(t),l=typeof document<"u"?i.useLayoutEffect:i.useEffect;function c(u){const g=i.useReducer(()=>({}),{})[1],f={...u,onChange:(w,C)=>{var y;C?n.flushSync(g):g(),(y=u.onChange)==null||y.call(u,w,C)}},[S]=i.useState(()=>new r.Virtualizer(f));return S.setOptions(f),i.useEffect(()=>S._didMount(),[]),l(()=>S._willUpdate()),S}function p(u){return c({observeElementRect:r.observeElementRect,observeElementOffset:r.observeElementOffset,scrollToFn:r.elementScroll,...u})}function s(u){return c({getScrollElement:()=>typeof document<"u"?window:null,observeElementRect:r.observeWindowRect,observeElementOffset:r.observeWindowOffset,scrollToFn:r.windowScroll,initialOffset:()=>typeof document<"u"?window.scrollY:0,...u})}e.useVirtualizer=p,e.useWindowVirtualizer=s,Object.keys(r).forEach(u=>{u!=="default"&&!Object.prototype.hasOwnProperty.call(e,u)&&Object.defineProperty(e,u,{enumerable:!0,get:()=>r[u]})})})(On);var vr={},qt={},Sn={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.useColumnWidths=e.getColumnWidths=void 0;const t=V,n=(o,i)=>{const l=i.map(({basis:p,minWidth:s,maxWidth:u})=>({basis:p,minWidth:s,maxWidth:u,size:p,violation:0,frozen:!1,factor:0}));let c=l.reduce((p,s)=>p-s.size,o);c>0?i.forEach(({grow:p},s)=>{l[s].factor=p}):c<0&&i.forEach(({shrink:p},s)=>{l[s].factor=p});for(const p of l)p.factor===0&&(p.frozen=!0);for(;l.some(({frozen:p})=>!p);){const p=l.reduce((u,g)=>u+(g.frozen?0:g.factor),0);let s=0;for(const u of l)u.frozen||(u.size+=c*u.factor/p,u.size<u.minWidth?u.violation=u.minWidth-u.size:u.maxWidth!==void 0&&u.size>u.maxWidth?u.violation=u.maxWidth-u.size:u.violation=0,u.size+=u.violation,s+=u.violation);if(s>0)for(const u of l)u.violation>0&&(u.frozen=!0);else if(s<0)for(const u of l)u.violation<0&&(u.frozen=!0);else break;c=l.reduce((u,g)=>u-g.size,o)}return l.map(({size:p})=>p)};e.getColumnWidths=n;const r=(o,i)=>{const l=o.map(({basis:c,minWidth:p,maxWidth:s,grow:u,shrink:g})=>[c,p,s,u,g].join(",")).join("|");return(0,t.useMemo)(()=>{if(i===void 0)return{fullWidth:!1,columnWidths:void 0,columnRights:void 0,totalWidth:void 0};const c=(0,e.getColumnWidths)(i,o);let p=0;const s=c.map((u,g)=>(p+=u,g===c.length-1?1/0:p));return{fullWidth:Math.abs(i-p)<.1,columnWidths:c,columnRights:s,totalWidth:p}},[i,l])};e.useColumnWidths=r})(Sn);var Kt=function(e,t){return Kt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},Kt(e,t)};function Cn(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Kt(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var He=function(){return He=Object.assign||function(t){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},He.apply(this,arguments)};function Dn(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n}var lt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pr(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Ht=pr,gr=typeof lt=="object"&&lt&&lt.Object===Object&&lt,br=gr,_r=br,yr=typeof self=="object"&&self&&self.Object===Object&&self,wr=_r||yr||Function("return this")(),Mn=wr,Or=Mn,Er=function(){return Or.Date.now()},xr=Er,Sr=/\s/;function Cr(e){for(var t=e.length;t--&&Sr.test(e.charAt(t)););return t}var Dr=Cr,Mr=Dr,Rr=/^\s+/;function jr(e){return e&&e.slice(0,Mr(e)+1).replace(Rr,"")}var Ir=jr,Tr=Mn,Pr=Tr.Symbol,Rn=Pr,dn=Rn,jn=Object.prototype,zr=jn.hasOwnProperty,Nr=jn.toString,Qe=dn?dn.toStringTag:void 0;function Ar(e){var t=zr.call(e,Qe),n=e[Qe];try{e[Qe]=void 0;var r=!0}catch{}var o=Nr.call(e);return r&&(t?e[Qe]=n:delete e[Qe]),o}var $r=Ar,Fr=Object.prototype,Lr=Fr.toString;function Vr(e){return Lr.call(e)}var Br=Vr,fn=Rn,Wr=$r,Gr=Br,Kr="[object Null]",Ur="[object Undefined]",mn=fn?fn.toStringTag:void 0;function kr(e){return e==null?e===void 0?Ur:Kr:mn&&mn in Object(e)?Wr(e):Gr(e)}var qr=kr;function Hr(e){return e!=null&&typeof e=="object"}var Xr=Hr,Yr=qr,Zr=Xr,Jr="[object Symbol]";function Qr(e){return typeof e=="symbol"||Zr(e)&&Yr(e)==Jr}var eo=Qr,to=Ir,hn=Ht,no=eo,vn=NaN,ro=/^[-+]0x[0-9a-f]+$/i,oo=/^0b[01]+$/i,lo=/^0o[0-7]+$/i,io=parseInt;function so(e){if(typeof e=="number")return e;if(no(e))return vn;if(hn(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=hn(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=to(e);var n=oo.test(e);return n||lo.test(e)?io(e.slice(2),n?2:8):ro.test(e)?vn:+e}var ao=so,uo=Ht,Vt=xr,pn=ao,co="Expected a function",fo=Math.max,mo=Math.min;function ho(e,t,n){var r,o,i,l,c,p,s=0,u=!1,g=!1,f=!0;if(typeof e!="function")throw new TypeError(co);t=pn(t)||0,uo(n)&&(u=!!n.leading,g="maxWait"in n,i=g?fo(pn(n.maxWait)||0,t):i,f="trailing"in n?!!n.trailing:f);function S(M){var T=r,$=o;return r=o=void 0,s=M,l=e.apply($,T),l}function w(M){return s=M,c=setTimeout(I,t),u?S(M):l}function C(M){var T=M-p,$=M-s,H=t-T;return g?mo(H,i-$):H}function y(M){var T=M-p,$=M-s;return p===void 0||T>=t||T<0||g&&$>=i}function I(){var M=Vt();if(y(M))return d(M);c=setTimeout(I,C(M))}function d(M){return c=void 0,f&&r?S(M):(r=o=void 0,l)}function v(){c!==void 0&&clearTimeout(c),s=0,r=p=o=c=void 0}function b(){return c===void 0?l:d(Vt())}function O(){var M=Vt(),T=y(M);if(r=arguments,o=this,p=M,T){if(c===void 0)return w(p);if(g)return clearTimeout(c),c=setTimeout(I,t),S(p)}return c===void 0&&(c=setTimeout(I,t)),l}return O.cancel=v,O.flush=b,O}var In=ho,vo=In,po=Ht,go="Expected a function";function bo(e,t,n){var r=!0,o=!0;if(typeof e!="function")throw new TypeError(go);return po(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),vo(e,t,{leading:r,maxWait:t,trailing:o})}var _o=bo,Tn=function(e,t,n,r){switch(t){case"debounce":return In(e,n,r);case"throttle":return _o(e,n,r);default:return e}},Ut=function(e){return typeof e=="function"},ze=function(){return typeof window>"u"},gn=function(e){return e instanceof Element||e instanceof HTMLDocument},Pn=function(e,t,n,r){return function(o){var i=o.width,l=o.height;t(function(c){return c.width===i&&c.height===l||c.width===i&&!r||c.height===l&&!n?c:(e&&Ut(e)&&e(i,l),{width:i,height:l})})}},zn=function(e){Cn(t,e);function t(n){var r=e.call(this,n)||this;r.cancelHandler=function(){r.resizeHandler&&r.resizeHandler.cancel&&(r.resizeHandler.cancel(),r.resizeHandler=null)},r.attachObserver=function(){var s=r.props,u=s.targetRef,g=s.observerOptions;if(!ze()){u&&u.current&&(r.targetRef.current=u.current);var f=r.getElement();f&&(r.observableElement&&r.observableElement===f||(r.observableElement=f,r.resizeObserver.observe(f,g)))}},r.getElement=function(){var s=r.props,u=s.querySelector,g=s.targetDomEl;if(ze())return null;if(u)return document.querySelector(u);if(g&&gn(g))return g;if(r.targetRef&&gn(r.targetRef.current))return r.targetRef.current;var f=wn.findDOMNode(r);if(!f)return null;var S=r.getRenderType();switch(S){case"renderProp":return f;case"childFunction":return f;case"child":return f;case"childArray":return f;default:return f.parentElement}},r.createResizeHandler=function(s){var u=r.props,g=u.handleWidth,f=g===void 0?!0:g,S=u.handleHeight,w=S===void 0?!0:S,C=u.onResize;if(!(!f&&!w)){var y=Pn(C,r.setState.bind(r),f,w);s.forEach(function(I){var d=I&&I.contentRect||{},v=d.width,b=d.height,O=!r.skipOnMount&&!ze();O&&y({width:v,height:b}),r.skipOnMount=!1})}},r.getRenderType=function(){var s=r.props,u=s.render,g=s.children;return Ut(u)?"renderProp":Ut(g)?"childFunction":V.isValidElement(g)?"child":Array.isArray(g)?"childArray":"parent"};var o=n.skipOnMount,i=n.refreshMode,l=n.refreshRate,c=l===void 0?1e3:l,p=n.refreshOptions;return r.state={width:void 0,height:void 0},r.skipOnMount=o,r.targetRef=V.createRef(),r.observableElement=null,ze()||(r.resizeHandler=Tn(r.createResizeHandler,i,c,p),r.resizeObserver=new window.ResizeObserver(r.resizeHandler)),r}return t.prototype.componentDidMount=function(){this.attachObserver()},t.prototype.componentDidUpdate=function(){this.attachObserver()},t.prototype.componentWillUnmount=function(){ze()||(this.observableElement=null,this.resizeObserver.disconnect(),this.cancelHandler())},t.prototype.render=function(){var n=this.props,r=n.render,o=n.children,i=n.nodeType,l=i===void 0?"div":i,c=this.state,p=c.width,s=c.height,u={width:p,height:s,targetRef:this.targetRef},g=this.getRenderType(),f;switch(g){case"renderProp":return r&&r(u);case"childFunction":return f=o,f(u);case"child":if(f=o,f.type&&typeof f.type=="string"){u.targetRef;var S=Dn(u,["targetRef"]);return V.cloneElement(f,S)}return V.cloneElement(f,u);case"childArray":return f=o,f.map(function(w){return!!w&&V.cloneElement(w,u)});default:return V.createElement(l,null)}},t}(V.PureComponent);function yo(e,t){t===void 0&&(t={});var n=function(i){Cn(l,i);function l(){var c=i!==null&&i.apply(this,arguments)||this;return c.ref=V.createRef(),c}return l.prototype.render=function(){var c=this.props,p=c.forwardedRef,s=Dn(c,["forwardedRef"]),u=p??this.ref;return V.createElement(zn,He({},t,{targetRef:u}),V.createElement(e,He({targetRef:u},s)))},l}(V.Component);function r(i,l){return V.createElement(n,He({},i,{forwardedRef:l}))}var o=e.displayName||e.name;return r.displayName="withResizeDetector(".concat(o,")"),V.forwardRef(r)}var wo=ze()?V.useEffect:V.useLayoutEffect;function Oo(e){e===void 0&&(e={});var t=e.skipOnMount,n=t===void 0?!1:t,r=e.refreshMode,o=e.refreshRate,i=o===void 0?1e3:o,l=e.refreshOptions,c=e.handleWidth,p=c===void 0?!0:c,s=e.handleHeight,u=s===void 0?!0:s,g=e.targetRef,f=e.observerOptions,S=e.onResize,w=V.useRef(n),C=V.useRef(null),y=g??C,I=V.useRef(),d=V.useState({width:void 0,height:void 0}),v=d[0],b=d[1];return wo(function(){if(!ze()){var O=Pn(S,b,p,u),M=function($){!p&&!u||$.forEach(function(H){var ie=H&&H.contentRect||{},re=ie.width,U=ie.height,x=!w.current&&!ze();x&&O({width:re,height:U}),w.current=!1})};I.current=Tn(M,r,i,l);var T=new window.ResizeObserver(I.current);return y.current&&T.observe(y.current,f),function(){T.disconnect();var $=I.current;$&&$.cancel&&$.cancel()}}},[r,i,l,p,u,S,f,y.current]),He({ref:y},v)}const Eo=Object.freeze(Object.defineProperty({__proto__:null,default:zn,useResizeDetector:Oo,withResizeDetector:yo},Symbol.toStringTag,{value:"Module"})),xo=hr(Eo);var Nn={};(function(e){var t=E&&E.__createBinding||(Object.create?function(w,C,y,I){I===void 0&&(I=y);var d=Object.getOwnPropertyDescriptor(C,y);(!d||("get"in d?!C.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return C[y]}}),Object.defineProperty(w,I,d)}:function(w,C,y,I){I===void 0&&(I=y),w[I]=C[y]}),n=E&&E.__setModuleDefault||(Object.create?function(w,C){Object.defineProperty(w,"default",{enumerable:!0,value:C})}:function(w,C){w.default=C}),r=E&&E.__importStar||function(w){if(w&&w.__esModule)return w;var C={};if(w!=null)for(var y in w)y!=="default"&&Object.prototype.hasOwnProperty.call(w,y)&&t(C,w,y);return n(C,w),C};Object.defineProperty(e,"__esModule",{value:!0}),e.useColumns=e.parseFlexValue=void 0;const o=r(V),i=()=>o.default.createElement(o.default.Fragment,null),l=()=>!1,c=({rowData:w})=>w,p=()=>null,s=({rowIndex:w})=>o.default.createElement(o.default.Fragment,null,w+1),u=()=>!0,g=w=>w,f=w=>{if(typeof w=="number")return{basis:0,grow:w,shrink:1};if(w.match(/^ *\d+(\.\d*)? *$/))return{basis:0,grow:parseFloat(w.trim()),shrink:1};if(w.match(/^ *\d+(\.\d*)? *px *$/))return{basis:parseFloat(w.trim()),grow:1,shrink:1};if(w.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *$/)){const[C,y]=w.trim().split(" ");return{basis:0,grow:parseFloat(C),shrink:parseFloat(y)}}if(w.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[C,y]=w.trim().split(" ");return{basis:parseFloat(y),grow:parseFloat(C),shrink:1}}if(w.match(/^ *\d+(\.\d*)? \d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[C,y,I]=w.trim().split(" ");return{basis:parseFloat(I),grow:parseFloat(C),shrink:parseFloat(y)}}return{basis:0,grow:1,shrink:1}};e.parseFlexValue=f;const S=(w,C,y)=>(0,o.useMemo)(()=>{var I,d,v,b,O,M,T,$,H,ie;const re=[C===!1?{basis:0,grow:0,shrink:0,minWidth:0,component:()=>o.default.createElement(o.default.Fragment,null),headerClassName:"dsg-hidden-cell",cellClassName:"dsg-hidden-cell",isCellEmpty:u}:Object.assign(Object.assign({},C),{basis:(I=C==null?void 0:C.basis)!==null&&I!==void 0?I:40,grow:(d=C==null?void 0:C.grow)!==null&&d!==void 0?d:0,shrink:(v=C==null?void 0:C.shrink)!==null&&v!==void 0?v:0,minWidth:(b=C==null?void 0:C.minWidth)!==null&&b!==void 0?b:0,title:(O=C==null?void 0:C.title)!==null&&O!==void 0?O:o.default.createElement("div",{className:"dsg-corner-indicator"}),component:(M=C==null?void 0:C.component)!==null&&M!==void 0?M:s,isCellEmpty:u}),...w];return y&&re.push(Object.assign(Object.assign({},y),{basis:(T=y==null?void 0:y.basis)!==null&&T!==void 0?T:40,grow:($=y==null?void 0:y.grow)!==null&&$!==void 0?$:0,shrink:(H=y==null?void 0:y.shrink)!==null&&H!==void 0?H:0,minWidth:(ie=y.minWidth)!==null&&ie!==void 0?ie:0,isCellEmpty:u})),re.map(U=>{var x,k,X,F,N,le,K,oe,ce,P,B,Y,ge,xe,se,Te;const Ce=U.width!==void 0?(0,e.parseFlexValue)(U.width):{basis:void 0,grow:void 0,shrink:void 0};return Object.assign(Object.assign({},U),{basis:(k=(x=U.basis)!==null&&x!==void 0?x:Ce.basis)!==null&&k!==void 0?k:0,grow:(F=(X=U.grow)!==null&&X!==void 0?X:Ce.grow)!==null&&F!==void 0?F:1,shrink:(le=(N=U.shrink)!==null&&N!==void 0?N:Ce.shrink)!==null&&le!==void 0?le:1,minWidth:(K=U.minWidth)!==null&&K!==void 0?K:100,component:(oe=U.component)!==null&&oe!==void 0?oe:i,disableKeys:(ce=U.disableKeys)!==null&&ce!==void 0?ce:!1,disabled:(P=U.disabled)!==null&&P!==void 0?P:!1,keepFocus:(B=U.keepFocus)!==null&&B!==void 0?B:!1,deleteValue:(Y=U.deleteValue)!==null&&Y!==void 0?Y:c,copyValue:(ge=U.copyValue)!==null&&ge!==void 0?ge:p,pasteValue:(xe=U.pasteValue)!==null&&xe!==void 0?xe:c,prePasteValues:(se=U.prePasteValues)!==null&&se!==void 0?se:g,isCellEmpty:(Te=U.isCellEmpty)!==null&&Te!==void 0?Te:l})})},[C,y,w]);e.useColumns=S})(Nn);var ft={},Xe={};Object.defineProperty(Xe,"__esModule",{value:!0});function kt(e,t,n,r){var o,i=!1,l=0;function c(){o&&clearTimeout(o)}function p(){c(),i=!0}typeof t!="boolean"&&(r=n,n=t,t=void 0);function s(){for(var u=arguments.length,g=new Array(u),f=0;f<u;f++)g[f]=arguments[f];var S=this,w=Date.now()-l;if(i)return;function C(){l=Date.now(),n.apply(S,g)}function y(){o=void 0}r&&!o&&C(),c(),r===void 0&&w>e?C():t!==!0&&(o=setTimeout(r?y:C,r===void 0?e-w:e))}return s.cancel=p,s}function So(e,t,n){return n===void 0?kt(e,t,!1):kt(e,n,t!==!1)}Xe.debounce=So;Xe.throttle=kt;var tt={},An=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,o,i;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(o=r;o--!==0;)if(!e(t[o],n[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(i=Object.keys(t),r=i.length,r!==Object.keys(n).length)return!1;for(o=r;o--!==0;)if(!Object.prototype.hasOwnProperty.call(n,i[o]))return!1;for(o=r;o--!==0;){var l=i[o];if(!e(t[l],n[l]))return!1}return!0}return t!==t&&n!==n},Co=E&&E.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(tt,"__esModule",{value:!0});tt.useDeepEqualState=void 0;const bn=V,Do=Co(An),Mo=e=>{const[t,n]=(0,bn.useState)(e),r=(0,bn.useCallback)(o=>{n(i=>{const l=typeof o=="function"?o(i):o;return(0,Do.default)(l,i)?i:l})},[n]);return[t,r]};tt.useDeepEqualState=Mo;Object.defineProperty(ft,"__esModule",{value:!0});ft.useEdges=void 0;const Ro=V,jo=Xe,Io=tt,To=(e,t,n)=>{const[r,o]=(0,Io.useDeepEqualState)({top:!0,right:!0,bottom:!0,left:!0});return(0,Ro.useEffect)(()=>{const i=(0,jo.throttle)(100,()=>{var c,p,s,u,g,f,S,w,C,y;o({top:((c=e.current)===null||c===void 0?void 0:c.scrollTop)===0,right:((s=(p=e.current)===null||p===void 0?void 0:p.scrollLeft)!==null&&s!==void 0?s:0)>=((g=(u=e.current)===null||u===void 0?void 0:u.scrollWidth)!==null&&g!==void 0?g:0)-(t??0)-1,bottom:((S=(f=e.current)===null||f===void 0?void 0:f.scrollTop)!==null&&S!==void 0?S:0)>=((C=(w=e.current)===null||w===void 0?void 0:w.scrollHeight)!==null&&C!==void 0?C:0)-(n??0)-1,left:((y=e.current)===null||y===void 0?void 0:y.scrollLeft)===0})}),l=e.current;return l==null||l.addEventListener("scroll",i),setTimeout(i,100),()=>{l==null||l.removeEventListener("scroll",i),i.cancel()}},[n,t,e,o]),r};ft.useEdges=To;var nt={};Object.defineProperty(nt,"__esModule",{value:!0});nt.useDocumentEventListener=void 0;const Po=V,zo=(e,t)=>{(0,Po.useEffect)(()=>(document.addEventListener(e,t),()=>{document.removeEventListener(e,t)}),[t,e])};nt.useDocumentEventListener=zo;var mt={};Object.defineProperty(mt,"__esModule",{value:!0});mt.useGetBoundingClientRect=void 0;const Bt=V,No=Xe,Ao=(e,t=200)=>{const n=(0,Bt.useRef)(null),r=(0,Bt.useMemo)(()=>(0,No.throttle)(t,!0,()=>{setTimeout(()=>{var o;return n.current=((o=e.current)===null||o===void 0?void 0:o.getBoundingClientRect())||null},0)}),[e,t]);return(0,Bt.useCallback)((o=!1)=>{var i;return o?n.current=((i=e.current)===null||i===void 0?void 0:i.getBoundingClientRect())||null:r(),n.current},[e,r])};mt.useGetBoundingClientRect=Ao;var Xt={};(function(e){var t=E&&E.__createBinding||(Object.create?function(l,c,p,s){s===void 0&&(s=p);var u=Object.getOwnPropertyDescriptor(c,p);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[p]}}),Object.defineProperty(l,s,u)}:function(l,c,p,s){s===void 0&&(s=p),l[s]=c[p]}),n=E&&E.__setModuleDefault||(Object.create?function(l,c){Object.defineProperty(l,"default",{enumerable:!0,value:c})}:function(l,c){l.default=c}),r=E&&E.__importStar||function(l){if(l&&l.__esModule)return l;var c={};if(l!=null)for(var p in l)p!=="default"&&Object.prototype.hasOwnProperty.call(l,p)&&t(c,l,p);return n(c,l),c};Object.defineProperty(e,"__esModule",{value:!0}),e.AddRows=e.createAddRowsComponent=void 0;const o=r(V),i=(l={})=>({addRows:c})=>{var p,s;const[u,g]=(0,o.useState)(1),[f,S]=(0,o.useState)(String(u));return o.default.createElement("div",{className:"dsg-add-row"},o.default.createElement("button",{type:"button",className:"dsg-add-row-btn",onClick:()=>c(u)},(p=l.button)!==null&&p!==void 0?p:"Add")," ",o.default.createElement("input",{className:"dsg-add-row-input",value:f,onBlur:()=>S(String(u)),type:"number",min:1,onChange:w=>{S(w.target.value),g(Math.max(1,Math.round(parseInt(w.target.value)||0)))},onKeyDown:w=>{w.key==="Enter"&&c(u)}})," ",(s=l.unit)!==null&&s!==void 0?s:"rows")};e.createAddRowsComponent=i,e.AddRows=(0,e.createAddRowsComponent)(),e.AddRows.displayName="AddRows"})(Xt);var ht={};Object.defineProperty(ht,"__esModule",{value:!0});ht.useDebounceState=void 0;const it=V,$o=Xe,Fo=(e,t)=>{const[n,r]=(0,it.useState)(e),o=(0,it.useRef)();(0,it.useEffect)(()=>()=>{var l;return(l=o.current)===null||l===void 0?void 0:l.cancel()},[]);const i=(0,it.useMemo)(()=>o.current=(0,$o.debounce)(t,l=>{r(l)}),[t]);return[n,i]};ht.useDebounceState=Fo;var Yt={};(function(e){var t=E&&E.__createBinding||(Object.create?function(s,u,g,f){f===void 0&&(f=g);var S=Object.getOwnPropertyDescriptor(u,g);(!S||("get"in S?!u.__esModule:S.writable||S.configurable))&&(S={enumerable:!0,get:function(){return u[g]}}),Object.defineProperty(s,f,S)}:function(s,u,g,f){f===void 0&&(f=g),s[f]=u[g]}),n=E&&E.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),r=E&&E.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var g in s)g!=="default"&&Object.prototype.hasOwnProperty.call(s,g)&&t(u,s,g);return n(u,s),u};Object.defineProperty(e,"__esModule",{value:!0}),e.ContextMenu=e.createContextMenuComponent=e.defaultRenderItem=void 0;const o=r(V),i=V,l=nt,c=s=>s.type==="CUT"?o.createElement(o.Fragment,null,"Cut"):s.type==="COPY"?o.createElement(o.Fragment,null,"Copy"):s.type==="PASTE"?o.createElement(o.Fragment,null,"Paste"):s.type==="DELETE_ROW"?o.createElement(o.Fragment,null,"Delete row"):s.type==="DELETE_ROWS"?o.createElement(o.Fragment,null,"Delete rows ",o.createElement("b",null,s.fromRow)," to ",o.createElement("b",null,s.toRow)):s.type==="INSERT_ROW_BELLOW"?o.createElement(o.Fragment,null,"Insert row below"):s.type==="DUPLICATE_ROW"?o.createElement(o.Fragment,null,"Duplicate row"):s.type==="DUPLICATE_ROWS"?o.createElement(o.Fragment,null,"Duplicate rows ",o.createElement("b",null,s.fromRow)," to ",o.createElement("b",null,s.toRow)):s.type;e.defaultRenderItem=c;const p=(s=e.defaultRenderItem)=>({clientX:u,clientY:g,items:f,close:S})=>{const w=(0,i.useRef)(null),C=(0,i.useCallback)(y=>{var I;((I=w.current)===null||I===void 0?void 0:I.contains(y.target))||S()},[S]);return(0,l.useDocumentEventListener)("mousedown",C),o.createElement("div",{className:"dsg-context-menu",style:{left:u+"px",top:g+"px"},ref:w},f.map(y=>o.createElement("div",{key:y.type,onClick:y.action,className:"dsg-context-menu-item"},s(y))))};e.createContextMenuComponent=p,e.ContextMenu=(0,e.createContextMenuComponent)(e.defaultRenderItem),e.ContextMenu.displayName="ContextMenu"})(Yt);var Se={},vt={};Object.defineProperty(vt,"__esModule",{value:!0});vt.parseDom=void 0;const Lo=typeof DOMParser<"u"?new DOMParser:{parseFromString:()=>null},Vo=e=>Lo.parseFromString(e,"text/html");vt.parseDom=Vo;Object.defineProperty(Se,"__esModule",{value:!0});Se.isPrintableUnicode=Se.encodeHtml=Se.parseTextPlainData=Se.parseTextHtmlData=void 0;const Bo=vt,Wo=e=>{var t,n;const r=(0,Bo.parseDom)(e.replace(/<br\/?>/g,`
`)),o=r.getElementsByTagName("table")[0];if(o){const l=[];for(let c=0;c<o.rows.length;c++){const p=[];l.push(p);for(let s=0;s<o.rows[c].cells.length;s++)p.push((t=o.rows[c].cells[s].textContent)!==null&&t!==void 0?t:"")}return l}const i=r.getElementsByTagName("span")[0];return i?[[(n=i.textContent)!==null&&n!==void 0?n:""]]:[[""]]};Se.parseTextHtmlData=Wo;const Go=e=>{const t=e.replace(/\r|\n$/g,""),n=[[]];let r=0,o=0,i=!1,l=0;const c=()=>{let p=t.slice(o,r);i&&p[p.length-1]==='"'&&p.includes(`
`)&&(p=p.slice(1,p.length-1).replace(/""/g,'"')),i&&p[p.length-1]!=='"'?p.split(`
`).forEach((s,u,{length:g})=>{n[l].push(s),u<g-1&&(n.push([]),l++)}):n[l].push(p)};for(;r<t.length;)i&&t[r]==='"'&&![void 0,"	",'"'].includes(t[r+1])&&(i=!1),i&&t[r]==='"'&&t[r+1]==='"'&&r++,r===o&&t[r]==='"'&&(i=!0),t[r]==="	"&&(c(),o=r+1,i=!1),t[r]===`
`&&!i&&(c(),n.push([]),o=r+1,l++),r++;return c(),n};Se.parseTextPlainData=Go;const Ko=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");Se.encodeHtml=Ko;const Uo=e=>e.match(/^[^\x00-\x20\x7F-\x9F]$/)!==null;Se.isPrintableUnicode=Uo;var $n={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getSelectionWithId=e.getSelection=e.getCellWithId=e.getCell=void 0;const t=(i,l,c,p)=>{if(i===null||!l||!c)return null;if(typeof i!="object")throw new Error("Value must be an object or null");const s=p.findIndex(g=>g.id===i.col),u={col:Math.max(0,Math.min(l-1,s===-1?Number(i.col):s-1)),row:Math.max(0,Math.min(c-1,Number(i.row)))};if(isNaN(u.col)||isNaN(u.row))throw new Error("col or cell are not valid positive numbers");return u};e.getCell=t;const n=(i,l)=>{var c;return i?{col:i.col,row:i.row,colId:(c=l[i.col+1])===null||c===void 0?void 0:c.id}:null};e.getCellWithId=n;const r=(i,l,c,p)=>{if(i===null||!l||!c)return null;if(typeof i!="object")throw new Error("Value must be an object or null");const s={min:(0,e.getCell)(i.min,l,c,p),max:(0,e.getCell)(i.max,l,c,p)};if(!s.min||!s.max)throw new Error("min and max must be defined");return s};e.getSelection=r;const o=(i,l)=>i?{min:(0,e.getCellWithId)(i.min,l),max:(0,e.getCellWithId)(i.max,l)}:null;e.getSelectionWithId=o})($n);var pt={};Object.defineProperty(pt,"__esModule",{value:!0});pt.getAllTabbableElements=void 0;const ko=()=>Array.from(document.querySelectorAll("*")).filter(e=>e instanceof HTMLElement&&typeof e.tabIndex=="number"&&e.tabIndex>=0&&!e.disabled&&(!(e instanceof HTMLAnchorElement)||!!e.href||e.getAttribute("tabIndex")!==null)&&getComputedStyle(e).visibility!=="collapse");pt.getAllTabbableElements=ko;var gt={},Fn={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function n(){for(var i="",l=0;l<arguments.length;l++){var c=arguments[l];c&&(i=o(i,r(c)))}return i}function r(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return n.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var l="";for(var c in i)t.call(i,c)&&i[c]&&(l=o(l,c));return l}function o(i,l){return l?i?i+" "+l:i+l:i}e.exports?(n.default=n,e.exports=n):window.classNames=n})()})(Fn);var Ye=Fn.exports,bt={},Ln=E&&E.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(bt,"__esModule",{value:!0});bt.Cell=void 0;const qo=Ln(V),Ho=Ln(Ye),Xo=({children:e,gutter:t,stickyRight:n,active:r,disabled:o,className:i,width:l,left:c})=>qo.default.createElement("div",{className:(0,Ho.default)("dsg-cell",t&&"dsg-cell-gutter",o&&"dsg-cell-disabled",t&&r&&"dsg-cell-gutter-active",n&&"dsg-cell-sticky-right",i),style:{width:l,left:n?void 0:c}},e);bt.Cell=Xo;var _t={};Object.defineProperty(_t,"__esModule",{value:!0});_t.useMemoizedIndexCallback=void 0;const Yo=V,Zo=(e,t)=>(0,Yo.useMemo)(()=>{const n=new Map;return r=>(n.has(r)||n.set(r,(...o)=>{e(r,...o.slice(0,t))}),n.get(r))},[t,e]);_t.useMemoizedIndexCallback=Zo;var Jo=E&&E.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),Qo=E&&E.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),el=E&&E.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&Jo(t,e,n);return Qo(t,e),t},tl=E&&E.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(gt,"__esModule",{value:!0});gt.Grid=void 0;const Wt=On,je=el(V),st=tl(Ye),_n=bt,at=_t,nl=({data:e,columns:t,outerRef:n,innerRef:r,columnWidths:o,hasStickyRightColumn:i,displayHeight:l,headerRowHeight:c,rowHeight:p,rowKey:s,fullWidth:u,selection:g,activeCell:f,rowClassName:S,cellClassName:w,children:C,editing:y,getContextMenuItems:I,setRowData:d,deleteRows:v,duplicateRows:b,insertRowAfter:O,stopEditing:M,onScroll:T})=>{var $,H,ie,re;const U=(0,Wt.useVirtualizer)({count:e.length,getScrollElement:()=>n.current,paddingStart:c,estimateSize:P=>p(P).height,getItemKey:P=>{if(s&&P>0){const B=e[P-1];if(typeof s=="function")return s({rowData:B,rowIndex:P});if(typeof s=="string"&&B instanceof Object&&s in B){const Y=B[s];if(typeof Y=="string"||typeof Y=="number")return Y}}return P},overscan:5}),x=(0,Wt.useVirtualizer)({count:t.length,getScrollElement:()=>n.current,estimateSize:P=>{var B;return(B=o==null?void 0:o[P])!==null&&B!==void 0?B:100},horizontal:!0,getItemKey:P=>{var B;return(B=t[P].id)!==null&&B!==void 0?B:P},overscan:1,rangeExtractor:P=>{const B=(0,Wt.defaultRangeExtractor)(P);return B[0]!==0&&B.unshift(0),i&&B[B.length-1]!==t.length-1&&B.push(t.length-1),B}});(0,je.useEffect)(()=>{x.measure()},[x,o]);const k=(0,at.useMemoizedIndexCallback)(d,1),X=(0,at.useMemoizedIndexCallback)(v,0),F=(0,at.useMemoizedIndexCallback)(b,0),N=(0,at.useMemoizedIndexCallback)(O,0),le=($=g==null?void 0:g.min.col)!==null&&$!==void 0?$:f==null?void 0:f.col,K=(H=g==null?void 0:g.max.col)!==null&&H!==void 0?H:f==null?void 0:f.col,oe=(ie=g==null?void 0:g.min.row)!==null&&ie!==void 0?ie:f==null?void 0:f.row,ce=(re=g==null?void 0:g.max.row)!==null&&re!==void 0?re:f==null?void 0:f.row;return je.default.createElement("div",{ref:n,className:"dsg-container",onScroll:T,style:{height:l}},je.default.createElement("div",{ref:r,style:{width:u?"100%":x.getTotalSize(),height:U.getTotalSize()}},c>0&&je.default.createElement("div",{className:(0,st.default)("dsg-row","dsg-row-header"),style:{width:u?"100%":x.getTotalSize(),height:c}},x.getVirtualItems().map(P=>je.default.createElement(_n.Cell,{key:P.key,gutter:P.index===0,stickyRight:i&&P.index===t.length-1,width:P.size,left:P.start,className:(0,st.default)("dsg-cell-header",le!==void 0&&K!==void 0&&le<=P.index-1&&K>=P.index-1&&"dsg-cell-header-active",t[P.index].headerClassName)},je.default.createElement("div",{className:"dsg-cell-header-container"},t[P.index].title)))),U.getVirtualItems().map(P=>{const B=P.index>=(oe??1/0)&&P.index<=(ce??-1/0);return je.default.createElement("div",{key:P.key,className:(0,st.default)("dsg-row",typeof S=="string"?S:null,typeof S=="function"?S({rowData:e[P.index],rowIndex:P.index}):null),style:{height:P.size,top:P.start,width:u?"100%":x.getTotalSize()}},x.getVirtualItems().map(Y=>{const ge=t[Y.index].cellClassName,xe=t[Y.index].disabled,se=t[Y.index].component,Te=xe===!0||typeof xe=="function"&&xe({rowData:e[P.index],rowIndex:P.index}),Ce=(f==null?void 0:f.row)===P.index&&f.col===Y.index-1;return je.default.createElement(_n.Cell,{key:Y.key,gutter:Y.index===0,stickyRight:i&&Y.index===t.length-1,active:Y.index===0&&B,disabled:Te,className:(0,st.default)(typeof ge=="function"?ge({rowData:e[P.index],rowIndex:P.index,columnId:t[Y.index].id}):ge,typeof w=="function"?w({rowData:e[P.index],rowIndex:P.index,columnId:t[Y.index].id}):w),width:Y.size,left:Y.start},je.default.createElement(se,{rowData:e[P.index],getContextMenuItems:I,disabled:Te,active:Ce,columnIndex:Y.index-1,rowIndex:P.index,focus:Ce&&y,deleteRow:X(P.index),duplicateRow:F(P.index),stopEditing:M,insertRowBelow:N(P.index),setRowData:k(P.index),columnData:t[Y.index].columnData}))}))}),C))};gt.Grid=nl;var Vn={};(function(e){var t=E&&E.__createBinding||(Object.create?function(s,u,g,f){f===void 0&&(f=g);var S=Object.getOwnPropertyDescriptor(u,g);(!S||("get"in S?!u.__esModule:S.writable||S.configurable))&&(S={enumerable:!0,get:function(){return u[g]}}),Object.defineProperty(s,f,S)}:function(s,u,g,f){f===void 0&&(f=g),s[f]=u[g]}),n=E&&E.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),r=E&&E.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var g in s)g!=="default"&&Object.prototype.hasOwnProperty.call(s,g)&&t(u,s,g);return n(u,s),u},o=E&&E.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionRect=void 0;const i=r(V),l=o(Ye),c=(s,u,g,f)=>[[f,s],[u,s],[u,g],[f,g],[f,s]],p=(s,u,g,f)=>`polygon(evenodd, ${[...c(0,"100%","100%",0),...c(s,u,g,f)].map(w=>w.map(C=>typeof C=="number"&&C!==0?C+"px":C).join(" ")).join(",")})`;e.SelectionRect=i.default.memo(({columnWidths:s,columnRights:u,headerRowHeight:g,selection:f,rowHeight:S,activeCell:w,hasStickyRightColumn:C,dataLength:y,viewWidth:I,viewHeight:d,contentWidth:v,edges:b,isCellDisabled:O,editing:M,expandSelection:T})=>{var $,H,ie,re;const U=w?O(w):!1,x=(0,i.useMemo)(()=>{if(!f)return U;for(let P=f.min.col;P<=f.max.col;++P)for(let B=f.min.row;B<=f.max.row;++B)if(!O({col:P,row:B}))return!1;return!0},[U,O,f]);if(!s||!u)return null;const k=P=>P<y-1?1:0,X=P=>P<s.length-(C?3:2)?1:0,F=w&&{width:s[w.col+1]+X(w.col),height:S(w.row).height+k(w.row),left:u[w.col],top:S(w.row).top+g},N=f&&{width:s.slice(f.min.col+1,f.max.col+2).reduce((P,B)=>P+B)+X(f.max.col),height:S(f.max.row).top+S(f.max.row).height-S(f.min.row).top+k(f.max.row),left:u[f.min.col],top:S(f.min.row).top+g},le=(f==null?void 0:f.min)||w,K=(f==null?void 0:f.max)||w,oe=K&&T!==null&&{left:u[K.col]+s[K.col+1],top:S(K.row).top+S(K.row).height+g,transform:`translate(-${K.col<s.length-(C?3:2)?50:100}%, -${K.row<y-1?50:100}%)`},ce=le&&K&&T!==null&&{width:s.slice(le.col+1,K.col+2).reduce((P,B)=>P+B)+X(K.col),height:S(K.row+T).top+S(K.row+T).height-S(K.row+1).top+k(K.row+T)-1,left:u[le.col],top:S(K.row).top+S(K.row).height+g+1};return i.default.createElement(i.default.Fragment,null,i.default.createElement("div",{className:"dsg-scrollable-view-container",style:{height:S(y-1).top+S(y-1).height+g,width:v||"100%"}},i.default.createElement("div",{className:(0,l.default)({"dsg-scrollable-view":!0,"dsg-scrollable-view-t":!b.top,"dsg-scrollable-view-r":!b.right,"dsg-scrollable-view-b":!b.bottom,"dsg-scrollable-view-l":!b.left}),style:{top:g,left:s[0],height:d?d-g:0,width:v&&I?I-s[0]-(C?s[s.length-1]:0):`calc(100% - ${s[0]+(C?s[s.length-1]:0)}px)`}})),(N||F)&&i.default.createElement("div",{className:"dsg-selection-col-marker-container",style:{left:($=N==null?void 0:N.left)!==null&&$!==void 0?$:F==null?void 0:F.left,width:(H=N==null?void 0:N.width)!==null&&H!==void 0?H:F==null?void 0:F.width,height:S(y-1).top+S(y-1).height+g}},i.default.createElement("div",{className:(0,l.default)("dsg-selection-col-marker",x&&"dsg-selection-col-marker-disabled"),style:{top:g}})),(N||F)&&i.default.createElement("div",{className:"dsg-selection-row-marker-container",style:{top:(ie=N==null?void 0:N.top)!==null&&ie!==void 0?ie:F==null?void 0:F.top,height:(re=N==null?void 0:N.height)!==null&&re!==void 0?re:F==null?void 0:F.height,width:v||"100%"}},i.default.createElement("div",{className:(0,l.default)("dsg-selection-row-marker",x&&"dsg-selection-row-marker-disabled"),style:{left:s[0]}})),F&&w&&i.default.createElement("div",{className:(0,l.default)("dsg-active-cell",{"dsg-active-cell-focus":M,"dsg-active-cell-disabled":U}),style:F}),N&&F&&i.default.createElement("div",{className:(0,l.default)("dsg-selection-rect",x&&"dsg-selection-rect-disabled"),style:Object.assign(Object.assign({},N),{clipPath:p(F.top-N.top,F.left-N.left,F.top+F.height-N.top,F.left+F.width-N.left)})}),ce&&i.default.createElement("div",{className:(0,l.default)("dsg-expand-rows-rect"),style:ce}),oe&&i.default.createElement("div",{className:(0,l.default)("dsg-expand-rows-indicator",x&&"dsg-expand-rows-indicator-disabled"),style:oe}))}),e.SelectionRect.displayName="SelectionRect"})(Vn);var yt={};Object.defineProperty(yt,"__esModule",{value:!0});yt.useRowHeights=void 0;const Gt=V,rl=({value:e,rowHeight:t})=>{const n=(0,Gt.useRef)([]),[,r]=(0,Gt.useState)(0);return(0,Gt.useMemo)(()=>{const o=i=>{if(typeof t=="number")return Math.min(e.length-1,Math.max(-1,Math.floor(i/t)));let l=0,c=n.current.length-1;for(;l<=c;){const p=Math.floor((l+c)/2);if(n.current[p].top<i)l=p+1;else if(n.current[p].top>i)c=p-1;else return p}if(c===n.current.length-1&&e.length>n.current.length&&(!n.current.length||i>=n.current[c].top+n.current[c].height)){let p=c===-1?0:n.current[c].top+n.current[c].height;do{c++;const s=t({rowIndex:c,rowData:e[c]});n.current.push({height:s,top:p}),p+=s}while(p<=i&&c<n.current.length-1)}return c};return{resetAfter:i=>{n.current=n.current.slice(0,i),r(l=>l+1)},getRowSize:i=>{if(typeof t=="number")return{height:t,top:t*i};if(i>=e.length)return{height:0,top:0};if(i<n.current.length)return n.current[i];let l=n.current[n.current.length-1].top+n.current[n.current.length-1].height;for(let c=n.current.length;c<=i;c++){const p=t({rowIndex:c,rowData:e[c]});n.current.push({height:p,top:l}),l+=p}return n.current[i]},getRowIndex:o,totalSize:i=>{if(typeof t=="number")return e.length*t;const l=o(i);return n.current[l].top+n.current[l].height}}},[t,e])};yt.useRowHeights=rl;(function(e){var t=E&&E.__createBinding||(Object.create?function(x,k,X,F){F===void 0&&(F=X);var N=Object.getOwnPropertyDescriptor(k,X);(!N||("get"in N?!k.__esModule:N.writable||N.configurable))&&(N={enumerable:!0,get:function(){return k[X]}}),Object.defineProperty(x,F,N)}:function(x,k,X,F){F===void 0&&(F=X),x[F]=k[X]}),n=E&&E.__setModuleDefault||(Object.create?function(x,k){Object.defineProperty(x,"default",{enumerable:!0,value:k})}:function(x,k){x.default=k}),r=E&&E.__importStar||function(x){if(x&&x.__esModule)return x;var k={};if(x!=null)for(var X in x)X!=="default"&&Object.prototype.hasOwnProperty.call(x,X)&&t(k,x,X);return n(k,x),k},o=E&&E.__awaiter||function(x,k,X,F){function N(le){return le instanceof X?le:new X(function(K){K(le)})}return new(X||(X=Promise))(function(le,K){function oe(B){try{P(F.next(B))}catch(Y){K(Y)}}function ce(B){try{P(F.throw(B))}catch(Y){K(Y)}}function P(B){B.done?le(B.value):N(B.value).then(oe,ce)}P((F=F.apply(x,k||[])).next())})},i=E&&E.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(e,"__esModule",{value:!0}),e.DataSheetGrid=void 0;const l=r(V),c=Sn,p=xo,s=Nn,u=ft,g=tt,f=nt,S=mt,w=Xt,C=ht,y=i(An),I=Yt,d=Se,v=$n,b=pt,O=gt,M=Vn,T=yt,$=[],H=[],ie=()=>({}),re=()=>null,U=({rowData:x})=>Object.assign({},x);e.DataSheetGrid=l.default.memo(l.default.forwardRef(({value:x=$,className:k,style:X,height:F=400,onChange:N=re,columns:le=H,rowHeight:K=40,headerRowHeight:oe=typeof K=="number"?K:40,gutterColumn:ce,stickyRightColumn:P,rowKey:B,addRowsComponent:Y=w.AddRows,createRow:ge=ie,autoAddRow:xe=!1,lockRows:se=!1,disableExpandSelection:Te=!1,duplicateRow:Ce=U,contextMenuComponent:kn=I.ContextMenu,disableContextMenu:qn=!1,onFocus:Zt=re,onBlur:Jt=re,onActiveCellChange:Qt=re,onSelectionChange:en=re,rowClassName:Hn,cellClassName:Xn,onScroll:Yn},Zn)=>{var jt,It,Tt,Pt,zt,Nt;const $e=(0,l.useRef)(null),tn=qn||se,z=(0,s.useColumns)(le,ce,P),J=!!P,rt=(0,l.useRef)(null),Oe=(0,l.useRef)(null),At=(0,l.useRef)(null),$t=(0,l.useRef)(null),[Jn,Qn]=(0,C.useDebounceState)(1,100),{getRowSize:Fe,totalSize:er,getRowIndex:nn}=(0,T.useRowHeights)({value:x,rowHeight:K}),rn=Math.min(F,oe+er(F)+Jn),{width:Le,height:Ne}=(0,p.useResizeDetector)({targetRef:Oe,refreshMode:"throttle",refreshRate:100});Qn(Ne?rn-Ne:0);const tr=(0,u.useEdges)(Oe,Le,Ne),{fullWidth:on,totalWidth:nr,columnWidths:be,columnRights:Ee}=(0,c.useColumnWidths)(z,Le),[Ve,_e]=(0,l.useState)(null),[Be,rr]=(0,l.useState)([]),[ee,ae]=(0,l.useState)(!1),[We,ln]=(0,l.useState)(0),[Ge,sn]=(0,l.useState)(null),[m,q]=(0,g.useDeepEqualState)(null),[ue,G]=(0,g.useDeepEqualState)(null),h=(0,l.useMemo)(()=>m&&ue&&{min:{col:Math.min(m.col,ue.col),row:Math.min(m.row,ue.row)},max:{col:Math.max(m.col,ue.col),row:Math.max(m.row,ue.row)}},[m,ue]),[De,Ke]=(0,g.useDeepEqualState)({columns:!1,rows:!1,active:!1}),or=Te||ee||De.active||(m==null?void 0:m.row)===(x==null?void 0:x.length)-1||(h==null?void 0:h.max.row)===(x==null?void 0:x.length)-1||m&&z.slice(((jt=h==null?void 0:h.min.col)!==null&&jt!==void 0?jt:m.col)+1,((It=h==null?void 0:h.max.col)!==null&&It!==void 0?It:m.col)+2).every(a=>a.disabled===!0)?null:We,an=(0,S.useGetBoundingClientRect)(rt),un=(0,S.useGetBoundingClientRect)(Oe);(0,l.useEffect)(()=>{var a;m!==null&&(document.activeElement.blur(),(a=window.getSelection())===null||a===void 0||a.removeAllRanges())},[m!==null]);const Ae=(0,l.useCallback)((a,_=!1,D=!1)=>{const R=an(_),A=D&&un(_);if(R&&Ee&&be){let Q=a.clientX-R.left,j=a.clientY-R.top;return A&&(a.clientY-A.top<=oe&&(j=0),a.clientX-A.left<=be[0]&&(Q=0),J&&A.right-a.clientX<=be[be.length-1]&&(Q=Ee[Ee.length-2]+1)),{col:Ee.findIndex(W=>Q<W)-1,row:nn(j-oe)}}return null},[Ee,be,x.length,an,un,oe,J,nn]),me=(0,l.useRef)(x);me.current=x;const he=(0,l.useCallback)(a=>{const _=z[a.col+1].disabled;return!!(typeof _=="function"?_({rowData:me.current[a.row],rowIndex:a.row}):_)},[z]),Me=(0,l.useCallback)((a,_=1)=>{se||(G(null),ae(!1),N([...me.current.slice(0,a+1),...new Array(_).fill(0).map(ge),...me.current.slice(a+1)],[{type:"CREATE",fromRowIndex:a+1,toRowIndex:a+1+_}]),q(D=>({col:(D==null?void 0:D.col)||0,row:a+_,doNotScrollX:!0})))},[ge,se,N,q,G]),Ue=(0,l.useCallback)((a,_=a)=>{se||(N([...me.current.slice(0,_+1),...me.current.slice(a,_+1).map((D,R)=>Ce({rowData:D,rowIndex:R+a})),...me.current.slice(_+1)],[{type:"CREATE",fromRowIndex:_+1,toRowIndex:_+2+_-a}]),q({col:0,row:_+1,doNotScrollX:!0}),G({col:z.length-(J?3:2),row:2*_-a+1,doNotScrollX:!0}),ae(!1))},[z.length,Ce,se,N,q,G,J]),Re=(0,l.useCallback)(a=>{if(!(!Ne||!Le)){if(!a.doNotScrollY){const _=Fe(a.row).top,D=Fe(a.row).top+Fe(a.row).height+oe-Ne+1,R=Oe.current.scrollTop;R>_?Oe.current.scrollTop=_:R<D&&(Oe.current.scrollTop=D)}if(Ee&&be&&Oe.current&&!a.doNotScrollX){const _=Ee[a.col]-Ee[0],D=Ee[a.col]+be[a.col+1]+(J?be[be.length-1]:0)-Le+1,R=Oe.current.scrollLeft;R>_?Oe.current.scrollLeft=_:R<D&&(Oe.current.scrollLeft=D)}}},[Ne,Le,oe,Ee,be,Fe,J]);(0,l.useEffect)(()=>{ue&&Re(ue)},[ue,Re]),(0,l.useEffect)(()=>{m&&Re(m)},[m,Re]);const lr=(0,l.useCallback)((a,_)=>{var D,R;N([...(D=me.current)===null||D===void 0?void 0:D.slice(0,a),_,...(R=me.current)===null||R===void 0?void 0:R.slice(a+1)],[{type:"UPDATE",fromRowIndex:a,toRowIndex:a+1}])},[N]),ke=(0,l.useCallback)((a,_=a)=>{se||(ae(!1),q(D=>{const R=Math.min(me.current.length-2-_+a,a);return R<0?null:D&&{col:D.col,row:R}}),G(null),N([...me.current.slice(0,a),...me.current.slice(_+1)],[{type:"DELETE",fromRowIndex:a,toRowIndex:_+1}]))},[se,N,q,G]),ot=(0,l.useCallback)((a=!0)=>{if(!m)return;const _=(h==null?void 0:h.min)||m,D=(h==null?void 0:h.max)||m;if(x.slice(_.row,D.row+1).every((A,Q)=>z.every(j=>j.isCellEmpty({rowData:A,rowIndex:Q+_.row})))){a&&ke(_.row,D.row);return}const R=[...x];for(let A=_.row;A<=D.row;++A)for(let Q=_.col;Q<=D.col;++Q)if(!he({col:Q,row:A})){const{deleteValue:j=({rowData:W})=>W}=z[Q+1];R[A]=j({rowData:R[A],rowIndex:A})}if(a&&(0,y.default)(R,x)){q({col:0,row:_.row,doNotScrollX:!0}),G({col:z.length-(J?3:2),row:D.row,doNotScrollX:!0});return}N(R,[{type:"UPDATE",fromRowIndex:_.row,toRowIndex:D.row+1}])},[m,z,x,ke,he,N,h==null?void 0:h.max,h==null?void 0:h.min,q,G,J]),Ft=(0,l.useCallback)(({nextRow:a=!0}={})=>{(m==null?void 0:m.row)===me.current.length-1?a&&xe?Me(m.row):ae(!1):(ae(!1),a&&q(_=>_&&{col:_.col,row:_.row+1}))},[m==null?void 0:m.row,xe,Me,q]),Ze=(0,l.useCallback)(a=>o(void 0,void 0,void 0,function*(){var _,D;if(!ee&&m){const R=[],A=(h==null?void 0:h.min)||m,Q=(h==null?void 0:h.max)||m;for(let L=A.row;L<=Q.row;++L){R.push([]);for(let te=A.col;te<=Q.col;++te){const{copyValue:ne=()=>null}=z[te+1];R[L-A.row].push(ne({rowData:x[L],rowIndex:L}))}}const j=R.map(L=>L.join("	")).join(`
`),W=`<table>${R.map(L=>`<tr>${L.map(te=>`<td>${(0,d.encodeHtml)(String(te??"")).replace(/\n/g,"<br/>")}</td>`).join("")}</tr>`).join("")}</table>`;if(a!==void 0){(_=a.clipboardData)===null||_===void 0||_.setData("text/plain",j),(D=a.clipboardData)===null||D===void 0||D.setData("text/html",W),a.preventDefault();return}let Z=!1;if(navigator.clipboard.write!==void 0){const L=new Blob([j],{type:"text/plain"}),te=new Blob([W],{type:"text/html"}),ne=[new ClipboardItem({"text/plain":L,"text/html":te})];yield navigator.clipboard.write(ne).then(()=>{Z=!0})}else navigator.clipboard.writeText!==void 0?yield navigator.clipboard.writeText(j).then(()=>{Z=!0}):document.execCommand!==void 0&&document.execCommand("copy")&&(Z=!0);Z||alert("This action is unavailable in your browser, but you can still use Ctrl+C for copy or Ctrl+X for cut")}}),[m,z,x,ee,h]);(0,f.useDocumentEventListener)("copy",Ze);const Lt=(0,l.useCallback)(a=>{!ee&&m&&(Ze(a),ot(!1))},[m,ot,ee,Ze]);(0,f.useDocumentEventListener)("cut",Lt);const Je=(0,l.useCallback)(a=>o(void 0,void 0,void 0,function*(){var _,D;if(!ee&&m){const R=(h==null?void 0:h.min)||m,A=(h==null?void 0:h.max)||m,Q=yield Promise.all(a[0].map((j,W)=>{var Z,L;const te=(Z=z[R.col+W+1])===null||Z===void 0?void 0:Z.prePasteValues,ne=a.map(ve=>ve[W]);return(L=te==null?void 0:te(ne))!==null&&L!==void 0?L:ne}));if(a=a.map((j,W)=>Q.map(Z=>Z[W])),a.length===1){const j=[...x];for(let W=0;W<a[0].length;W++){const Z=(_=z[R.col+W+1])===null||_===void 0?void 0:_.pasteValue;if(Z)for(let L=R.row;L<=A.row;L++)he({col:W+R.col,row:L})||(j[L]=yield Z({rowData:j[L],value:a[0][W],rowIndex:L}))}N(j,[{type:"UPDATE",fromRowIndex:R.row,toRowIndex:A.row+1}]),q({col:R.col,row:R.row}),G({col:Math.min(R.col+a[0].length-1,z.length-(J?3:2)),row:A.row})}else{let j=[...x];const W=R.row+a.length-x.length;W>0&&(se?a.splice(a.length-W,W):j=[...j,...new Array(W).fill(0).map(()=>ge())]);for(let L=0;L<a[0].length&&R.col+L<z.length-(J?2:1);L++){const te=(D=z[R.col+L+1])===null||D===void 0?void 0:D.pasteValue;if(te)for(let ne=0;ne<a.length;ne++)he({col:R.col+L,row:R.row+ne})||(j[R.row+ne]=yield te({rowData:j[R.row+ne],value:a[ne][L],rowIndex:R.row+ne}))}const Z=[{type:"UPDATE",fromRowIndex:R.row,toRowIndex:R.row+a.length-(!se&&W>0?W:0)}];W>0&&!se&&Z.push({type:"CREATE",fromRowIndex:R.row+a.length-W,toRowIndex:R.row+a.length}),N(j,Z),q({col:R.col,row:R.row}),G({col:Math.min(R.col+a[0].length-1,z.length-(J?3:2)),row:R.row+a.length-1})}}}),[m,z,ge,x,ee,J,he,se,N,h==null?void 0:h.max,h==null?void 0:h.min,q,G]),ir=(0,l.useCallback)(a=>{var _,D,R,A,Q,j;if(m&&!ee){let W=[[""]];!((_=a.clipboardData)===null||_===void 0)&&_.types.includes("text/html")?W=(0,d.parseTextHtmlData)((D=a.clipboardData)===null||D===void 0?void 0:D.getData("text/html")):!((R=a.clipboardData)===null||R===void 0)&&R.types.includes("text/plain")?W=(0,d.parseTextPlainData)((A=a.clipboardData)===null||A===void 0?void 0:A.getData("text/plain")):!((Q=a.clipboardData)===null||Q===void 0)&&Q.types.includes("text")&&(W=(0,d.parseTextPlainData)((j=a.clipboardData)===null||j===void 0?void 0:j.getData("text"))),Je(W),a.preventDefault()}},[m,Je,ee]);(0,f.useDocumentEventListener)("paste",ir);const sr=(0,l.useCallback)(a=>{var _,D,R;if(Ve&&Be.length)return;const A=a.button===2||a.button===0&&a.ctrlKey,Q=((_=rt.current)===null||_===void 0?void 0:_.contains(a.target))||!1,j=Q?Ae(a,!0,!0):null;if(!Q&&ee&&m&&z[m.col+1].keepFocus)return;if(a.target instanceof HTMLElement&&a.target.className.includes("dsg-expand-rows-indicator")){sn(Math.max((D=m==null?void 0:m.row)!==null&&D!==void 0?D:0,(R=h==null?void 0:h.max.row)!==null&&R!==void 0?R:0));return}const W=j&&m&&m.col===j.col&&m.row===j.row&&!he(m);if(W&&ee)return;const Z=(j==null?void 0:j.col)===z.length-2&&J,L=A&&h&&j&&j.row>=h.min.row&&j.row<=h.max.row&&j.col>=h.min.col&&j.col<=h.max.col,te=A&&h&&j&&j.row===-1&&j.col>=h.min.col&&j.col<=h.max.col,ne=A&&h&&j&&j.row>=h.min.row&&j.row<=h.max.row&&j.col===-1,ve=Z&&h&&j&&j.row>=h.min.row&&j.row<=h.max.row;if(A&&!tn&&_e({x:a.clientX,y:a.clientY,cursorIndex:j}),(!(a.shiftKey&&m)||A)&&x.length>0&&q(j&&{col:(L||te)&&m?m.col:Math.max(0,Z?0:j.col),row:(L||ne||ve)&&m?m.row:Math.max(0,j.row),doNotScrollX:!!(L&&m||Z||j.col===-1),doNotScrollY:!!(L&&m||j.row===-1)}),W&&!A&&($e.current=m),ae(!!(W&&!A)),Ke(j&&!A?{columns:j.col!==-1&&!Z||!!(a.shiftKey&&m),rows:j.row!==-1||!!(a.shiftKey&&m),active:!0}:{columns:!1,rows:!1,active:!1}),a.shiftKey&&m&&!A)G(j&&{col:Math.max(0,j.col-(Z?1:0)),row:Math.max(0,j.row)});else if(!L){if(j&&((j==null?void 0:j.col)===-1||(j==null?void 0:j.row)===-1||Z)){let de=j.col,pe=j.row,fe=!1,ye=!1;(j.col===-1||Z)&&(de=z.length-(J?3:2),fe=!0),j.row===-1&&(pe=x.length-1,ye=!0),te&&ue&&(de=ue.col,ye=!0),(ne||ve)&&ue&&(pe=ue.row,fe=!0),G({col:de,row:pe,doNotScrollX:fe,doNotScrollY:ye})}else G(null);Q&&a.preventDefault()}},[Ve,Be.length,Ae,ee,m,z,he,h,J,tn,Ke,q,G,ue,x.length]);(0,f.useDocumentEventListener)("mousedown",sr);const ar=(0,l.useCallback)(()=>{var a,_,D,R,A,Q,j,W,Z;if(Ge!==null){if(We>0&&m){let L=[];const te=(h==null?void 0:h.min)||m,ne=(h==null?void 0:h.max)||m;for(let ve=te.row;ve<=ne.row;++ve){L.push([]);for(let de=te.col;de<=ne.col;++de){const{copyValue:pe=()=>null}=z[de+1];L[ve-te.row].push(String((a=pe({rowData:x[ve],rowIndex:ve}))!==null&&a!==void 0?a:""))}}Promise.all(L[0].map((ve,de)=>{var pe,fe;const ye=(pe=z[te.col+de+1])===null||pe===void 0?void 0:pe.prePasteValues,we=L.map(mr=>mr[de]);return(fe=ye==null?void 0:ye(we))!==null&&fe!==void 0?fe:we})).then(ve=>{var de;L=L.map((fe,ye)=>ve.map(we=>we[ye]));const pe=[...x];for(let fe=0;fe<L[0].length;fe++){const ye=(de=z[te.col+fe+1])===null||de===void 0?void 0:de.pasteValue;if(ye)for(let we=ne.row+1;we<=ne.row+We;we++)he({col:fe+te.col,row:we})||(pe[we]=ye({rowData:pe[we],value:L[(we-ne.row-1)%L.length][fe],rowIndex:we}))}N(pe,[{type:"UPDATE",fromRowIndex:ne.row+1,toRowIndex:ne.row+1+We}])}),ln(0),q({col:Math.min((_=m==null?void 0:m.col)!==null&&_!==void 0?_:1/0,(D=h==null?void 0:h.min.col)!==null&&D!==void 0?D:1/0),row:Math.min((R=m==null?void 0:m.row)!==null&&R!==void 0?R:1/0,(A=h==null?void 0:h.min.row)!==null&&A!==void 0?A:1/0),doNotScrollX:!0,doNotScrollY:!0}),G({col:Math.max((Q=m==null?void 0:m.col)!==null&&Q!==void 0?Q:0,(j=h==null?void 0:h.max.col)!==null&&j!==void 0?j:0),row:Math.max((W=m==null?void 0:m.row)!==null&&W!==void 0?W:0,(Z=h==null?void 0:h.max.row)!==null&&Z!==void 0?Z:0)+We})}sn(null)}Ke({columns:!1,rows:!1,active:!1})},[Ge,Ke,We,m,h==null?void 0:h.min,h==null?void 0:h.max,x,N,q,G,z,he]);(0,f.useDocumentEventListener)("mouseup",ar);const ur=(0,l.useCallback)(a=>{if(Ge!==null){const _=Ae(a);_&&(ln(Math.max(0,_.row-Ge)),Re({col:_.col,row:Math.max(_.row,Ge)}))}if(De.active){const _=Ae(a),D=z.length-(J?3:2);G(_&&{col:De.columns?Math.max(0,Math.min(D,_.col)):D,row:De.rows?Math.max(0,_.row):x.length-1,doNotScrollX:!De.columns,doNotScrollY:!De.rows}),ae(!1)}},[Re,De.active,De.columns,De.rows,Ae,z.length,J,G,x.length,Ge]);(0,f.useDocumentEventListener)("mousemove",ur);const cr=(0,l.useCallback)(a=>{if(m&&!a.isComposing){if(a.key==="Tab"&&!a.shiftKey&&m.col===z.length-(J?3:2)&&!z[m.col+1].disableKeys)if(m.row===x.length-1){if($t.current){a.preventDefault(),q(null),G(null),ae(!1);const _=(0,b.getAllTabbableElements)(),D=_.indexOf($t.current);_[(D+1)%_.length].focus();return}}else{q(_=>{var D;return{col:0,row:((D=_==null?void 0:_.row)!==null&&D!==void 0?D:0)+1}}),G(null),ae(!1),a.preventDefault();return}if(a.key==="Tab"&&a.shiftKey&&m.col===0&&!z[m.col+1].disableKeys)if(m.row===0){if(At.current){a.preventDefault(),q(null),G(null),ae(!1);const _=(0,b.getAllTabbableElements)(),D=_.indexOf(At.current);_[(D-1+_.length)%_.length].focus();return}}else{q(_=>{var D;return{col:z.length-(J?3:2),row:((D=_==null?void 0:_.row)!==null&&D!==void 0?D:1)-1}}),G(null),ae(!1),a.preventDefault();return}if(a.key.startsWith("Arrow")||a.key==="Tab"){if(ee&&z[m.col+1].disableKeys||ee&&["ArrowLeft","ArrowRight"].includes(a.key))return;const _=([D,R],A)=>A&&{col:Math.max(0,Math.min(z.length-(J?3:2),A.col+D)),row:Math.max(0,Math.min(x.length-1,A.row+R))};if(a.key==="Tab"&&a.shiftKey)q(D=>_([-1,0],D)),G(null);else{const D={ArrowDown:[0,1],ArrowUp:[0,-1],ArrowLeft:[-1,0],ArrowRight:[1,0],Tab:[1,0]}[a.key];(a.ctrlKey||a.metaKey)&&(D[0]*=z.length,D[1]*=x.length),a.shiftKey?G(R=>_(D,R||m)):(q(R=>_(D,R)),G(null))}ae(!1),a.preventDefault()}else a.key==="Escape"?(!ee&&!ue&&q(null),G(null),ae(!1)):(a.key==="Enter"||a.key==="F2")&&!a.ctrlKey&&!a.metaKey&&!a.altKey&&!a.shiftKey?(G(null),ee?z[m.col+1].disableKeys||(Ft(),a.preventDefault()):he(m)||($e.current=m,ae(!0),Re(m),a.preventDefault())):a.key==="Enter"&&!a.ctrlKey&&!a.metaKey&&!a.altKey&&a.shiftKey?Me((h==null?void 0:h.max.row)||m.row):a.key==="d"&&(a.ctrlKey||a.metaKey)&&!a.altKey&&!a.shiftKey?(Ue((h==null?void 0:h.min.row)||m.row,h==null?void 0:h.max.row),a.preventDefault()):((0,d.isPrintableUnicode)(a.key)||a.code.match(/Key[A-Z]$/))&&!a.ctrlKey&&!a.metaKey&&!a.altKey?!ee&&!he(m)&&($e.current=m,G(null),ae(!0),Re(m)):["Backspace","Delete"].includes(a.key)?ee||(ot(),a.preventDefault()):a.key==="a"&&(a.ctrlKey||a.metaKey)&&(ee||(q({col:0,row:0,doNotScrollY:!0,doNotScrollX:!0}),G({col:z.length-(J?3:2),row:x.length-1,doNotScrollY:!0,doNotScrollX:!0}),a.preventDefault()))}},[m,z,x.length,ot,Ue,ee,Me,he,Re,h==null?void 0:h.max.row,h==null?void 0:h.min.row,ue,q,G,Ft,J]);(0,f.useDocumentEventListener)("keydown",cr);const dr=(0,l.useCallback)(a=>{var _;const D=((_=rt.current)===null||_===void 0?void 0:_.contains(a.target))||!1,R=D?Ae(a,!0,!0):null,A=R&&m&&m.col===R.col&&m.row===R.row&&ee;D&&!A&&a.preventDefault()},[Ae,m,ee]);(0,f.useDocumentEventListener)("contextmenu",dr),(0,l.useEffect)(()=>{const a=[];(m==null?void 0:m.row)!==void 0&&a.push({type:"COPY",action:()=>{Ze(),_e(null)}},{type:"CUT",action:()=>{Lt(),_e(null)}},{type:"PASTE",action:()=>o(void 0,void 0,void 0,function*(){if(navigator.clipboard.read!==void 0)(yield navigator.clipboard.read()).forEach(D=>o(void 0,void 0,void 0,function*(){let R=[[""]];if(D.types.includes("text/html")){const A=yield D.getType("text/html");R=(0,d.parseTextHtmlData)(yield A.text())}else if(D.types.includes("text/plain")){const A=yield D.getType("text/plain");R=(0,d.parseTextPlainData)(yield A.text())}else if(D.types.includes("text")){const A=yield D.getType("text");R=(0,d.parseTextHtmlData)(yield A.text())}Je(R)}));else if(navigator.clipboard.readText!==void 0){const _=yield navigator.clipboard.readText();Je((0,d.parseTextPlainData)(_))}else alert("This action is unavailable in your browser, but you can still use Ctrl+V for paste");_e(null)})}),(h==null?void 0:h.max.row)!==void 0?a.push({type:"INSERT_ROW_BELLOW",action:()=>{_e(null),Me(h.max.row)}}):(m==null?void 0:m.row)!==void 0&&a.push({type:"INSERT_ROW_BELLOW",action:()=>{_e(null),Me(m.row)}}),(h==null?void 0:h.min.row)!==void 0&&h.min.row!==h.max.row?a.push({type:"DUPLICATE_ROWS",fromRow:h.min.row+1,toRow:h.max.row+1,action:()=>{_e(null),Ue(h.min.row,h.max.row)}}):(m==null?void 0:m.row)!==void 0&&a.push({type:"DUPLICATE_ROW",action:()=>{_e(null),Ue(m.row)}}),(h==null?void 0:h.min.row)!==void 0&&h.min.row!==h.max.row?a.push({type:"DELETE_ROWS",fromRow:h.min.row+1,toRow:h.max.row+1,action:()=>{_e(null),ke(h.min.row,h.max.row)}}):(m==null?void 0:m.row)!==void 0&&a.push({type:"DELETE_ROW",action:()=>{_e(null),ke(m.row)}}),rr(a),a.length||_e(null)},[h,m,ke,Ue,Me,Lt,Ze,Je]);const cn=(0,l.useRef)(Be);cn.current=Be;const fr=(0,l.useCallback)(()=>cn.current,[]);(0,l.useImperativeHandle)(Zn,()=>({activeCell:(0,v.getCellWithId)(m,z),selection:(0,v.getSelectionWithId)(h??(m?{min:m,max:m}:null),z),setSelection:a=>{const _=(0,v.getSelection)(a,z.length-(J?2:1),x.length,z);q((_==null?void 0:_.min)||null),ae(!1),Ke({columns:!1,active:!1,rows:!1}),G((_==null?void 0:_.max)||null)},setActiveCell:a=>{const _=(0,v.getCell)(a,z.length-(J?2:1),x.length,z);q(_),ae(!1),Ke({columns:!1,active:!1,rows:!1}),G(null)}}));const Pe=(0,l.useRef)({onFocus:Zt,onBlur:Jt,onActiveCellChange:Qt,onSelectionChange:en});return Pe.current.onFocus=Zt,Pe.current.onBlur=Jt,Pe.current.onActiveCellChange=Qt,Pe.current.onSelectionChange=en,(0,l.useEffect)(()=>{$e.current&&(ee?Pe.current.onFocus({cell:(0,v.getCellWithId)($e.current,z)}):Pe.current.onBlur({cell:(0,v.getCellWithId)($e.current,z)}))},[ee,z]),(0,l.useEffect)(()=>{Pe.current.onActiveCellChange({cell:(0,v.getCellWithId)(m,z)})},[m==null?void 0:m.col,m==null?void 0:m.row,z]),(0,l.useEffect)(()=>{Pe.current.onSelectionChange({selection:(0,v.getSelectionWithId)(h??(m?{min:m,max:m}:null),z)})},[(Tt=h==null?void 0:h.min.col)!==null&&Tt!==void 0?Tt:m==null?void 0:m.col,(Pt=h==null?void 0:h.min.row)!==null&&Pt!==void 0?Pt:m==null?void 0:m.row,(zt=h==null?void 0:h.max.col)!==null&&zt!==void 0?zt:m==null?void 0:m.col,(Nt=h==null?void 0:h.max.row)!==null&&Nt!==void 0?Nt:m==null?void 0:m.row,m==null?void 0:m.col,m==null?void 0:m.row,z]),l.default.createElement("div",{className:k,style:X},l.default.createElement("div",{ref:At,tabIndex:le.length&&x.length?0:void 0,onFocus:a=>{a.target.blur(),q({col:0,row:0})}}),l.default.createElement(O.Grid,{columns:z,outerRef:Oe,columnWidths:be,hasStickyRightColumn:J,displayHeight:rn,data:x,fullWidth:on,headerRowHeight:oe,activeCell:m,innerRef:rt,rowHeight:Fe,rowKey:B,selection:h,rowClassName:Hn,editing:ee,getContextMenuItems:fr,setRowData:lr,deleteRows:ke,insertRowAfter:Me,duplicateRows:Ue,stopEditing:Ft,cellClassName:Xn,onScroll:Yn},l.default.createElement(M.SelectionRect,{columnRights:Ee,columnWidths:be,activeCell:m,selection:h,headerRowHeight:oe,rowHeight:Fe,hasStickyRightColumn:J,dataLength:x.length,viewHeight:Ne,viewWidth:Le,contentWidth:on?void 0:nr,edges:tr,editing:ee,isCellDisabled:he,expandSelection:or})),l.default.createElement("div",{ref:$t,tabIndex:le.length&&x.length?0:void 0,onFocus:a=>{a.target.blur(),q({col:z.length-(J?3:2),row:x.length-1})}}),!se&&Y&&l.default.createElement(Y,{addRows:a=>Me(x.length-1,a)}),Ve&&Be.length>0&&l.default.createElement(kn,{clientX:Ve.x,clientY:Ve.y,cursorIndex:Ve.cursorIndex,items:Be,close:()=>_e(null)}))})),e.DataSheetGrid.displayName="DataSheetGrid"})(qt);var wt={},ol=E&&E.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n},ll=E&&E.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(wt,"__esModule",{value:!0});wt.StaticDataSheetGrid=void 0;const il=V,sl=qt,yn=ll(V);wt.StaticDataSheetGrid=yn.default.forwardRef((e,t)=>{var{columns:n,gutterColumn:r,stickyRightColumn:o,addRowsComponent:i,createRow:l,duplicateRow:c,style:p,rowKey:s,onFocus:u,onBlur:g,onActiveCellChange:f,onSelectionChange:S,rowClassName:w,rowHeight:C}=e,y=ol(e,["columns","gutterColumn","stickyRightColumn","addRowsComponent","createRow","duplicateRow","style","rowKey","onFocus","onBlur","onActiveCellChange","onSelectionChange","rowClassName","rowHeight"]);const[I]=(0,il.useState)({columns:n,gutterColumn:r,stickyRightColumn:o,addRowsComponent:i,createRow:l,duplicateRow:c,style:p,rowKey:s,onFocus:u,onBlur:g,onActiveCellChange:f,onSelectionChange:S,rowClassName:w,rowHeight:C});return yn.default.createElement(sl.DataSheetGrid,Object.assign({},I,y,{rowHeight:typeof C=="number"?C:I.rowHeight,ref:t}))});var Ie={},Ot={};Object.defineProperty(Ot,"__esModule",{value:!0});Ot.useFirstRender=void 0;const al=V,ul=()=>{const e=(0,al.useRef)(!0),t=e.current;return e.current=!1,t};Ot.useFirstRender=ul;var cl=E&&E.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),dl=E&&E.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),fl=E&&E.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&cl(t,e,n);return dl(t,e),t},ml=E&&E.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ie,"__esModule",{value:!0});Ie.createTextColumn=Ie.textColumn=void 0;const qe=fl(V),hl=ml(Ye),vl=Ot,Bn=qe.default.memo(({active:e,focus:t,rowData:n,setRowData:r,columnData:{placeholder:o,alignRight:i,formatInputOnFocus:l,formatBlurredInput:c,parseUserInput:p,continuousUpdates:s}})=>{const u=(0,qe.useRef)(null),g=(0,vl.useFirstRender)(),f=(0,qe.useRef)({rowData:n,formatInputOnFocus:l,formatBlurredInput:c,setRowData:r,parseUserInput:p,continuousUpdates:s,firstRender:g,focusedAt:0,changedAt:0,escPressed:!1});return f.current={rowData:n,formatInputOnFocus:l,formatBlurredInput:c,setRowData:r,parseUserInput:p,continuousUpdates:s,firstRender:g,focusedAt:f.current.focusedAt,changedAt:f.current.changedAt,escPressed:f.current.escPressed},(0,qe.useLayoutEffect)(()=>{t?(u.current&&(u.current.value=f.current.formatInputOnFocus(f.current.rowData),u.current.focus(),u.current.select()),f.current.escPressed=!1,f.current.focusedAt=Date.now()):u.current&&(!f.current.escPressed&&!f.current.continuousUpdates&&!f.current.firstRender&&f.current.changedAt>=f.current.focusedAt&&f.current.setRowData(f.current.parseUserInput(u.current.value)),u.current.blur())},[t]),(0,qe.useEffect)(()=>{!t&&u.current&&(u.current.value=f.current.formatBlurredInput(n))},[t,n]),qe.default.createElement("input",{defaultValue:c(n),className:(0,hl.default)("dsg-input",i&&"dsg-input-align-right"),placeholder:e?o:void 0,tabIndex:-1,ref:u,style:{pointerEvents:t?"auto":"none"},onChange:S=>{f.current.changedAt=Date.now(),s&&r(p(S.target.value))},onKeyDown:S=>{S.key==="Escape"&&(f.current.escPressed=!0)}})});Bn.displayName="TextComponent";Ie.textColumn=Wn();function Wn({placeholder:e,alignRight:t=!1,continuousUpdates:n=!0,deletedValue:r=null,parseUserInput:o=s=>s.trim()||null,formatBlurredInput:i=s=>String(s??""),formatInputOnFocus:l=s=>String(s??""),formatForCopy:c=s=>String(s??""),parsePastedValue:p=s=>s.replace(/[\n\r]+/g," ").trim()||null}={}){return{component:Bn,columnData:{placeholder:e,alignRight:t,continuousUpdates:n,formatInputOnFocus:l,formatBlurredInput:i,parseUserInput:o},deleteValue:()=>r,copyValue:({rowData:s})=>c(s),pasteValue:({value:s})=>p(s),isCellEmpty:({rowData:s})=>s==null}}Ie.createTextColumn=Wn;var Et={},pl=E&&E.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),gl=E&&E.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),bl=E&&E.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&pl(t,e,n);return gl(t,e),t};Object.defineProperty(Et,"__esModule",{value:!0});Et.checkboxColumn=void 0;const ut=bl(V),_l=["","false","no","off","disabled","0","n","f","unchecked","undefined","null","wrong","negative"],Gn=ut.default.memo(({focus:e,rowData:t,setRowData:n,active:r,stopEditing:o,disabled:i})=>{const l=(0,ut.useRef)(null);return(0,ut.useLayoutEffect)(()=>{e&&(n(!t),o({nextRow:!1}))},[e,o]),ut.default.createElement("input",{className:"dsg-checkbox",tabIndex:-1,type:"checkbox",ref:l,disabled:i,checked:!!t,onMouseDown:()=>!r&&n(!t),onChange:()=>null})});Gn.displayName="CheckboxComponent";Et.checkboxColumn={component:Gn,deleteValue:()=>!1,copyValue:({rowData:e})=>e?"YES":"NO",pasteValue:({value:e})=>!_l.includes(e.toLowerCase()),isCellEmpty:({rowData:e})=>!e};var xt={};Object.defineProperty(xt,"__esModule",{value:!0});xt.floatColumn=void 0;const yl=Ie;xt.floatColumn=(0,yl.createTextColumn)({alignRight:!0,formatBlurredInput:e=>typeof e=="number"?new Intl.NumberFormat().format(e):"",parseUserInput:e=>{const t=parseFloat(e);return isNaN(t)?null:t},parsePastedValue:e=>{const t=parseFloat(e);return isNaN(t)?null:t}});var St={};Object.defineProperty(St,"__esModule",{value:!0});St.intColumn=void 0;const wl=Ie;St.intColumn=(0,wl.createTextColumn)({alignRight:!0,formatBlurredInput:e=>typeof e=="number"?new Intl.NumberFormat().format(e):"",parseUserInput:e=>{const t=parseFloat(e);return isNaN(t)?null:Math.round(t)},parsePastedValue:e=>{const t=parseFloat(e);return isNaN(t)?null:Math.round(t)}});var Ct={};Object.defineProperty(Ct,"__esModule",{value:!0});Ct.percentColumn=void 0;const Ol=Ie,El=1e12,xl=1e10;Ct.percentColumn=(0,Ol.createTextColumn)({alignRight:!0,formatBlurredInput:e=>typeof e=="number"?new Intl.NumberFormat(void 0,{style:"percent"}).format(e):"",formatInputOnFocus:e=>typeof e=="number"&&!isNaN(e)?String(Math.round(e*El)/xl):"",parseUserInput:e=>{const t=parseFloat(e);return isNaN(t)?null:t/100},parsePastedValue:e=>{const t=parseFloat(e);return isNaN(t)?null:t}});var Dt={},Sl=E&&E.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),Cl=E&&E.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Dl=E&&E.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&Sl(t,e,n);return Cl(t,e),t},Ml=E&&E.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Dt,"__esModule",{value:!0});Dt.dateColumn=void 0;const ct=Dl(V),Rl=Ml(Ye),Kn=ct.default.memo(({focus:e,active:t,rowData:n,setRowData:r})=>{var o;const i=(0,ct.useRef)(null);return(0,ct.useLayoutEffect)(()=>{var l,c;e?(l=i.current)===null||l===void 0||l.select():(c=i.current)===null||c===void 0||c.blur()},[e]),ct.default.createElement("input",{className:(0,Rl.default)("dsg-input",!t&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:i,style:{pointerEvents:e?"auto":"none",opacity:n||t?void 0:0},value:(o=n==null?void 0:n.toISOString().substr(0,10))!==null&&o!==void 0?o:"",onChange:l=>{const c=new Date(l.target.value);r(isNaN(c.getTime())?null:c)}})});Kn.displayName="DateComponent";Dt.dateColumn={component:Kn,deleteValue:()=>null,copyValue:({rowData:e})=>e?e.toISOString().substr(0,10):null,pasteValue:({value:e})=>{const t=new Date(e.replace(/\.\s?|\//g,"-"));return isNaN(t.getTime())?null:t},minWidth:170,isCellEmpty:({rowData:e})=>!e};var Mt={},jl=E&&E.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),Il=E&&E.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Tl=E&&E.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&jl(t,e,n);return Il(t,e),t},Pl=E&&E.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Mt,"__esModule",{value:!0});Mt.isoDateColumn=void 0;const dt=Tl(V),zl=Pl(Ye),Un=dt.default.memo(({focus:e,active:t,rowData:n,setRowData:r})=>{const o=(0,dt.useRef)(null);return(0,dt.useLayoutEffect)(()=>{var i,l;e?(i=o.current)===null||i===void 0||i.select():(l=o.current)===null||l===void 0||l.blur()},[e]),dt.default.createElement("input",{className:(0,zl.default)("dsg-input",!t&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:o,style:{pointerEvents:e?"auto":"none",opacity:n||t?void 0:0},value:n??"",onChange:i=>{const l=new Date(i.target.value);r(isNaN(l.getTime())?null:l.toISOString().substr(0,10))}})});Un.displayName="IsoDateComponent";Mt.isoDateColumn={component:Un,deleteValue:()=>null,pasteValue:({value:e})=>{const t=new Date(e.replace(/\.\s?|\//g,"-"));return isNaN(t.getTime())?null:t.toISOString().substr(0,10)},minWidth:170,isCellEmpty:({rowData:e})=>!e};var Rt={},Nl=E&&E.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),Al=E&&E.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),$l=E&&E.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&Nl(t,e,n);return Al(t,e),t},Fl=E&&E.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n};Object.defineProperty(Rt,"__esModule",{value:!0});Rt.keyColumn=void 0;const et=$l(V),Ll=e=>{var{columnData:{key:t,original:n},rowData:r,setRowData:o}=e,i=Fl(e,["columnData","rowData","setRowData"]);const l=(0,et.useRef)(r);l.current=r;const c=(0,et.useCallback)(s=>{o(Object.assign(Object.assign({},l.current),{[t]:s}))},[t,o]);if(!n.component)return et.default.createElement(et.default.Fragment,null);const p=n.component;return et.default.createElement(p,Object.assign({columnData:n.columnData,setRowData:c,rowData:r[t]},i))},Vl=(e,t)=>Object.assign(Object.assign({id:e},t),{columnData:{key:e,original:t},component:Ll,copyValue:({rowData:n,rowIndex:r})=>{var o,i;return(i=(o=t.copyValue)===null||o===void 0?void 0:o.call(t,{rowData:n[e],rowIndex:r}))!==null&&i!==void 0?i:null},deleteValue:({rowData:n,rowIndex:r})=>{var o,i;return Object.assign(Object.assign({},n),{[e]:(i=(o=t.deleteValue)===null||o===void 0?void 0:o.call(t,{rowData:n[e],rowIndex:r}))!==null&&i!==void 0?i:null})},pasteValue:({rowData:n,value:r,rowIndex:o})=>{var i,l;return Object.assign(Object.assign({},n),{[e]:(l=(i=t.pasteValue)===null||i===void 0?void 0:i.call(t,{rowData:n[e],value:r,rowIndex:o}))!==null&&l!==void 0?l:null})},disabled:typeof t.disabled=="function"?({rowData:n,rowIndex:r})=>{var o;return typeof t.disabled=="function"?t.disabled({rowData:n[e],rowIndex:r}):(o=t.disabled)!==null&&o!==void 0?o:!1}:t.disabled,cellClassName:typeof t.cellClassName=="function"?({rowData:n,rowIndex:r,columnId:o})=>{var i;return typeof t.cellClassName=="function"?t.cellClassName({rowData:n[e],rowIndex:r,columnId:o}):(i=t.cellClassName)!==null&&i!==void 0?i:void 0}:t.cellClassName,isCellEmpty:({rowData:n,rowIndex:r})=>{var o,i;return(i=(o=t.isCellEmpty)===null||o===void 0?void 0:o.call(t,{rowData:n[e],rowIndex:r}))!==null&&i!==void 0?i:!1}});Rt.keyColumn=Vl;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.renderContextMenuItem=e.createContextMenuComponent=e.createAddRowsComponent=e.keyColumn=e.isoDateColumn=e.dateColumn=e.percentColumn=e.intColumn=e.floatColumn=e.checkboxColumn=e.createTextColumn=e.textColumn=e.DataSheetGrid=e.DynamicDataSheetGrid=void 0;const t=qt,n=wt;e.DynamicDataSheetGrid=t.DataSheetGrid,e.DataSheetGrid=n.StaticDataSheetGrid;var r=Ie;Object.defineProperty(e,"textColumn",{enumerable:!0,get:function(){return r.textColumn}}),Object.defineProperty(e,"createTextColumn",{enumerable:!0,get:function(){return r.createTextColumn}});var o=Et;Object.defineProperty(e,"checkboxColumn",{enumerable:!0,get:function(){return o.checkboxColumn}});var i=xt;Object.defineProperty(e,"floatColumn",{enumerable:!0,get:function(){return i.floatColumn}});var l=St;Object.defineProperty(e,"intColumn",{enumerable:!0,get:function(){return l.intColumn}});var c=Ct;Object.defineProperty(e,"percentColumn",{enumerable:!0,get:function(){return c.percentColumn}});var p=Dt;Object.defineProperty(e,"dateColumn",{enumerable:!0,get:function(){return p.dateColumn}});var s=Mt;Object.defineProperty(e,"isoDateColumn",{enumerable:!0,get:function(){return s.isoDateColumn}});var u=Rt;Object.defineProperty(e,"keyColumn",{enumerable:!0,get:function(){return u.keyColumn}});var g=Xt;Object.defineProperty(e,"createAddRowsComponent",{enumerable:!0,get:function(){return g.createAddRowsComponent}});var f=Yt;Object.defineProperty(e,"createContextMenuComponent",{enumerable:!0,get:function(){return f.createContextMenuComponent}}),Object.defineProperty(e,"renderContextMenuItem",{enumerable:!0,get:function(){return f.defaultRenderItem}})})(vr);export{vr as d};
